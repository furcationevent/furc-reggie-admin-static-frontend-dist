var Se=Object.defineProperty,Te=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var se=(t,i,a)=>i in t?Se(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a,I=(t,i)=>{for(var a in i||(i={}))xe.call(i,a)&&se(t,a,i[a]);if(le)for(var a of le(i))Oe.call(i,a)&&se(t,a,i[a]);return t},W=(t,i)=>Te(t,ke(i));import{u as Ie,a as Ae,s as oe,M as Ee,c as Ne,r as d,j as o,T as Pe,b as e,C as De,B as je,d as Ge,I as te,e as Le,f as X,D as Ke,g as We,h as Me,i as Re,L as ee,k as F,l as ze,m as q,n as ce,o as ne,p as He,q as fe,t as Fe,v as k,w as qe,x as Be,y as $e,z as Ue,F as O,A as Q,P as Je,S as D,E as w,G as R,H as z,J as N,K as Ve,N as Xe,O as H,Q as P,R as v,U as Ye,V as Qe,W as Ze,X as $,Y as U,Z as ae,_ as Z,$ as et,a0 as ie,a1 as J,a2 as V,a3 as B,a4 as tt,a5 as Ce,a6 as nt,a7 as at,a8 as de,a9 as ue,aa as rt,ab as ot,ac as it,ad as lt,ae as st,af as M}from"./vendor.5aebe429.js";const ct=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))g(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&g(p)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function g(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}};ct();const K=()=>Ie(),ye=Ae,Y=240,dt=oe("main",{shouldForwardProp:t=>t!=="open"})(({theme:t,open:i})=>I({flexGrow:1,padding:t.spacing(3),transition:t.transitions.create("margin",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),marginLeft:`-${Y}px`},i&&{transition:t.transitions.create("margin",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen}),marginLeft:0})),ut=oe(Ee,{shouldForwardProp:t=>t!=="open"})(({theme:t,open:i})=>I({transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},i&&{width:`calc(100% - ${Y}px)`,marginLeft:`${Y}px`,transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen})})),he=oe("div")(({theme:t})=>W(I({display:"flex",alignItems:"center",padding:t.spacing(0,1)},t.mixins.toolbar),{justifyContent:"flex-end"}));function ht(t){const i=K(),a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,g=Ne({palette:{mode:a?"dark":"light"}}),[n,s]=d.exports.useState(!0),p=ye(S=>S.user.authed),u=()=>{s(!0)},b=()=>{s(!1)};let f;p?f={"/":{label:"Intro",icon:e(ce,{})},"/accommodation":{label:"Accommodation",icon:e(ne,{})},"/attendees":{label:"Attendees",icon:e(He,{})},"/groups":{label:"Groups",icon:e(fe,{})},"/config":{label:"Config",icon:e(Fe,{})}}:f={"/":{label:"Intro",icon:e(ce,{})}};const h="/"+window.location.pathname.split("/")[1],[C,l]=d.exports.useState(f[h].label),_=S=>{const j=f[S];l(j.label),i(k(S))};return o(Pe,{theme:g,children:[e(De,{}),o(je,{sx:{display:"flex"},children:[e(ut,{position:"fixed",open:n,children:o(Ge,{children:[e(te,{color:"inherit","aria-label":"open drawer",onClick:u,edge:"start",sx:I({mr:2},n&&{display:"none"}),children:e(Le,{})}),e(X,{variant:"h6",noWrap:!0,component:"div",children:C})]})}),o(Ke,{sx:{width:Y,flexShrink:0,"& .MuiDrawer-paper":{width:Y,boxSizing:"border-box"}},variant:"persistent",anchor:"left",open:n,children:[e(he,{children:e(te,{onClick:b,children:g.direction==="ltr"?e(We,{}):e(Me,{})})}),e(Re,{}),e(ee,{children:Object.keys(f).map(S=>o(F,{button:!0,onClick:()=>_(S),children:[e(ze,{children:f[S].icon}),e(q,{primary:f[S].label})]},S))})]}),o(dt,{open:n,children:[e(he,{}),t.children]})]})]})}const mt={authed:!!localStorage.getItem("TOKEN")},be=qe({name:"user",initialState:mt,reducers:{login(t){t.authed=!0},logout(t){t.authed=!1}}}),{login:pt,logout:L}=be.actions;var gt=be.reducer;const{createReduxHistory:ft,routerMiddleware:Ct,routerReducer:yt}=Be({history:$e()}),ve=Ue({reducer:{router:yt,user:gt},middleware:[Ct]}),bt=ft(ve),x=window.location.hostname=="localhost"?"http://localhost:8000/":"https://api.reg.furcation.org.uk/",vt=window.location.protocol+"//"+window.location.host;function wt(){return fetch(x+"auth/o/keycloak/?"+new URLSearchParams({redirect_uri:vt}),{method:"GET",credentials:"include"})}function _t(t,i){return fetch(x+"auth/o/keycloak/",{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({state:t,code:i})})}function St(){return fetch(x+"auth/users/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Tt(t){return fetch(x+"auth/users/"+t,{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function kt(t){return fetch(x+"auth/users/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function xt(){return fetch(x+"accommodation/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Ot(t){return fetch(x+"accommodation/"+t+"/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function It(t){return fetch(x+"accommodation/",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function At(t){return fetch(x+"accommodation/"+t.id+"/",{method:"DELETE",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Et(t){return fetch(x+"accommodation/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function we(){return fetch(x+"groups/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Nt(t){return fetch(x+"groups/"+t+"/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Pt(t){return fetch(x+"groups/"+t.id+"/",{method:"DELETE",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Dt(t,i){return fetch(x+"groups/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify({owner:{id:i,nickname:""}})})}function re(t){return fetch(x+"groups/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function jt(){return fetch(x+"config/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Gt(t){return fetch(x+"config/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify({value:t.value})})}function Lt(){const t=K(),i=ye(p=>p.user.authed),[a,g]=d.exports.useState("");return d.exports.useEffect(()=>{const p=new URLSearchParams(window.location.search),u=p.get("state"),b=p.get("code");!i&&u&&b&&_t(u,b).then(f=>{f.status==201?f.json().then(h=>{localStorage.setItem("TOKEN",h.access),t(pt())}):f.json().then(h=>{g("Login flow expired, please login again."),console.log(h)})})},[]),o(O,{children:[a?e(Q,{severity:"error",children:a}):null,o(Je,{variant:"outlined",sx:{my:{xs:3,md:6},p:{xs:2,md:3}},children:[e(X,{variant:"h6",color:"inherit",children:"Welcome to Furcation Registation Admin Panel"}),o(X,{variant:"body1",color:"inherit",paragraph:!0,children:["Welcome to the admin panel here you can view and edit attendees and groups for maintainance or resolving issues. For any issues please contact us:",e("br",{}),e("br",{}),"Registration - reg@furcation.org.uk",e("br",{}),"IT - it@furcation.org.uk"]}),i?e(D,{spacing:2,alignItems:"center",children:e(w,{color:"error",variant:"contained",sx:{minWidth:{sm:400,xs:"100%"}},onClick:()=>{t(L()),localStorage.removeItem("TOKEN")},children:"Logout"})}):e(D,{spacing:2,alignItems:"center",children:e(w,{variant:"contained",sx:{minWidth:{sm:400,xs:"100%"}},onClick:()=>{wt().then(p=>{p.status==200?p.json().then(u=>{window.location.href=u.authorization_url}):p.json().then(u=>{g("Error while contacting Keycloak, please try again or contact tech."),console.log(u)})})},children:"Login with Keycloak"})})]})]})}function Kt(t){const i=K(),[a,g]=d.exports.useState([]),[n,s]=d.exports.useState("");d.exports.useEffect(()=>{we().then(u=>{u.status==200?u.json().then(b=>{g(b.results.filter(f=>f.users.length<8)),s("0")}):u.status==401&&(i(k("/")),i(L()),localStorage.removeItem("TOKEN"))})},[]);const p=u=>{s(u.target.value)};return o(R,{open:t.open,onClose:()=>t.handleClose(null),children:[e(z,{children:"Pick a group"}),a?o(O,{children:[e(N,{children:e(Ve,{value:n,label:"Group",fullWidth:!0,variant:"standard",margin:"dense",onChange:p,children:a.map((u,b)=>o(Xe,{value:b,children:[u.owner.nickname,"'s Group"]},b))})}),o(H,{children:[e(w,{onClick:()=>t.handleClose(null),children:"Close"}),e(w,{onClick:()=>t.handleClose(a[parseInt(n)]),children:"Confirm"})]})]}):null]})}function Wt(t){const i=K(),[a,g]=d.exports.useState({}),[n,s]=d.exports.useState(null),[p,u]=d.exports.useState("1990-01-01"),[b,f]=d.exports.useState(0),[h,C]=d.exports.useState(!1);d.exports.useEffect(()=>{Tt(t.userId).then(m=>{m.status==200?m.json().then(T=>{s(T),u(T.date_of_birth)}):m.status==401?(i(k("/")),i(L()),localStorage.removeItem("TOKEN")):m.json().then(T=>{g(T),console.log(T)})})},[]);const l=m=>{n&&(n[m.target.name]=m.target.value,s(I({},n)))},_=m=>{n&&(n[m.target.name]=m.target.checked,s(I({},n)))},S=m=>{const T=new Date(m),G=T.getFullYear()+"-"+("0"+(T.getMonth()+1)).slice(-2)+"-"+("0"+T.getDate()).slice(-2);u(G),n&&(n.date_of_birth=G)},j=()=>{if(n){f(1);const m=I({},n);m.phone_number=r(m.phone_number),m.ice_phone=r(m.ice_phone),delete m.group,kt(m).then(T=>{console.log(T.status),T.status==200?T.json().then(G=>{f(2),s(G),u(G.date_of_birth)}):T.status==401?(i(k("/")),i(L()),localStorage.removeItem("TOKEN")):T.status==400&&(f(0),T.json().then(G=>{console.log(G),g(G)}))})}},r=m=>(m=m.replaceAll(" ",""),m.charAt(0)==="0"?"+44"+m.substring(1):m),c=()=>{C(!0)},E=m=>{n&&m&&(m.users.push({id:n.id,nickname:n.nickname,fully_paid:!1}),re(m).then(T=>{T.status==200&&s(W(I({},n),{group:m}))})),C(!1)};return o(O,{children:[o(R,{open:t.open,onClose:t.handleClose,scroll:"body",children:[e(z,{children:"Attendee"}),n?o(O,{children:[o(N,{children:[o(P,{children:["Badge Number:"," ",n.badge_override?n.badge_override+" (Overridden from "+n.id+")":n.id]}),e(v,{required:!0,name:"full_name",label:"Full (Legal) Name",value:n.full_name,onChange:l,autoComplete:"fullname",error:Object.prototype.hasOwnProperty.call(a,"full_name"),helperText:a.full_name,fullWidth:!0,variant:"standard",margin:"dense"}),e(v,{required:!0,name:"nickname",label:"Badge Name (Nickname/Furry Name)",value:n.nickname,onChange:l,autoComplete:"nickname",error:Object.prototype.hasOwnProperty.call(a,"nickname"),helperText:a.nickname,fullWidth:!0,variant:"standard",margin:"dense"}),e(v,{required:!0,name:"email",label:"Email",value:n.email,onChange:l,autoComplete:"email",error:Object.prototype.hasOwnProperty.call(a,"email"),helperText:a.email,fullWidth:!0,variant:"standard",margin:"dense"}),e(Ye,{dateAdapter:Qe,children:e(Ze,{label:"Date of Birth",value:p,onChange:S,inputFormat:"yyyy-MM-dd",mask:"____-__-__",renderInput:m=>e(v,W(I({},m),{required:!0,error:Object.prototype.hasOwnProperty.call(a,"date_of_birth"),helperText:a.date_of_birth,fullWidth:!0,variant:"standard",margin:"dense"}))})}),e(v,{required:!0,multiline:!0,rows:4,name:"address",label:"Address",value:n.address,onChange:l,error:Object.prototype.hasOwnProperty.call(a,"address"),helperText:a.address,fullWidth:!0,variant:"standard",margin:"dense"}),e(v,{required:!0,type:"tel",name:"phone_number",label:"Phone Number",autoComplete:"phone",value:n.phone_number,onChange:l,error:Object.prototype.hasOwnProperty.call(a,"phone_number"),helperText:a.phone_number,fullWidth:!0,variant:"standard",margin:"dense"}),e(v,{multiline:!0,rows:4,name:"medical_details",label:"Any medical details we should know? (optional)",value:n.medical_details||"",onChange:l,error:Object.prototype.hasOwnProperty.call(a,"medical_details"),helperText:a.medical_details,fullWidth:!0,variant:"standard",margin:"dense"}),e(v,{required:!0,name:"ice_name",label:"ICE Name",value:n.ice_name,onChange:l,autoComplete:"ice_name",error:Object.prototype.hasOwnProperty.call(a,"ice_name"),helperText:a.ice_name,fullWidth:!0,variant:"standard",margin:"dense"}),e(v,{required:!0,name:"ice_phone",label:"ICE Phone",value:n.ice_phone,onChange:l,autoComplete:"ice_phone",error:Object.prototype.hasOwnProperty.call(a,"ice_phone"),helperText:a.ice_phone,fullWidth:!0,variant:"standard",margin:"dense"}),e($,{control:e(U,{name:"is_fursuiter",checked:n.is_fursuiter,onChange:_}),label:"Fursuiter"}),e($,{control:e(U,{name:"is_early",checked:n.is_early,onChange:_}),label:"Early"}),e($,{control:e(U,{name:"is_late",checked:n.is_late,onChange:_}),label:"Late"}),e($,{control:e(U,{name:"is_sponsor",checked:n.is_sponsor,onChange:_}),label:"Sponsor"}),e(v,{name:"badge_override",label:"Badge Number Override",value:n.badge_override,onChange:l,autoComplete:"badge_override",error:Object.prototype.hasOwnProperty.call(a,"badge_override"),helperText:a.badge_override,fullWidth:!0,variant:"standard",margin:"dense"}),e(v,{name:"paid",label:"Amount paid",value:n.paid,onChange:l,autoComplete:"paid",type:"number",error:Object.prototype.hasOwnProperty.call(a,"paid"),InputProps:{endAdornment:e(ae,{position:"end",children:"p"})},helperText:a.paid,fullWidth:!0,variant:"standard",margin:"dense"}),e(v,{name:"adjustments",label:"Bill adjustments",value:n.adjustments,onChange:l,autoComplete:"adjustments",type:"number",error:Object.prototype.hasOwnProperty.call(a,"adjustments"),InputProps:{endAdornment:e(ae,{position:"end",children:"p"})},helperText:a.adjustments,fullWidth:!0,variant:"standard",margin:"dense"}),e(v,{multiline:!0,rows:4,name:"internal_notes",label:"Internal Notes",value:n.internal_notes||"",onChange:l,error:Object.prototype.hasOwnProperty.call(a,"internal_notes"),helperText:a.internal_notes,fullWidth:!0,variant:"standard",margin:"dense"})]}),e(N,{children:n.group?o(P,{children:["Group:"," ",o(Z,{to:"/groups/"+n.group.id,children:[n.group.owner.nickname,"'s Group"]})]}):o(P,{sx:{"& button":{m:1}},children:["No group",e(w,{size:"small",variant:"contained",color:"primary",onClick:c,children:"Add to a group"})]})}),o(H,{children:[e(w,{onClick:t.handleClose,children:"Close"}),e(et,{loading:b==1,color:b==2?"success":"primary",onClick:j,children:b==2?"Saved!":"Save Changes"})]})]}):null]}),h?e(Kt,{open:!0,handleClose:E}):null]})}function me(){const t=K(),{id:i}=ie(),[a,g]=d.exports.useState(""),[n,s]=d.exports.useState([]),[p,u]=d.exports.useState("");d.exports.useEffect(()=>{St().then(l=>{l.status==200?l.json().then(_=>{s(_.results)}):l.status==401?(t(k("/")),t(L()),localStorage.removeItem("TOKEN")):l.json().then(_=>{g("Error while retrieving attendees.  Please try again or contact tech."),console.log(_)})})},[]);const b=l=>{t(k("/attendees/"+l.id))},f=()=>{t(k("/attendees"))},h=l=>{u(l.target.value)},C=l=>l.toLowerCase().includes(p.toLowerCase());return o(O,{children:[a?e(Q,{severity:"error",children:a}):null,e(v,{fullWidth:!0,id:"outlined-basic",label:"Search",variant:"outlined",onChange:h}),e(ee,{children:n.filter(l=>l.email?C(l.full_name)||C(l.nickname)||C(l.email)||C(l.id+"")||C(l.badge_override):!1).map((l,_)=>e(F,{children:o(J,{onClick:()=>b(l),children:[e(V,{children:l.badge_image?e(B,{src:"https://storage.googleapis.com/reggie-badges/"+l.badge_image}):e(B,{children:e(tt,{})})}),e(q,{primary:l.nickname,secondary:l.full_name+" - "+l.email+" - #"+(l.badge_override?l.badge_override+" (Overridden from "+l.id+")":l.id)})]})},_))}),i?e(Wt,{open:!0,handleClose:f,userId:i}):null]})}function Mt(t){const i=K(),[a,g]=d.exports.useState(null),[n,s]=d.exports.useState(0),[p,u]=d.exports.useState(!1),[b,f]=d.exports.useState(""),[h,C]=d.exports.useState(!1);d.exports.useEffect(()=>{Nt(t.groupId).then(y=>{y.status==200?y.json().then(A=>{g(A),f(A.internal_notes)}):y.status==401&&(i(k("/")),i(L()),localStorage.removeItem("TOKEN"))})},[]);const l=y=>{s(y)},_=()=>{s(0)},S=()=>{a&&(a.users=a.users.filter(y=>y.id!==n),re(a).then(y=>{y.status==200&&y.json().then(A=>{g(A),s(0)})}))},j=()=>{u(!0)},r=()=>{u(!1)},c=()=>{a&&Pt(a).then(y=>{y.status==204&&(t.handleDeleted(a),i(k("/groups")))})},E=y=>{a&&Dt(a,y).then(A=>{A.json().then(_e=>g(_e))})},m=y=>{a&&f(y.target.value)},T=()=>{a&&(a.internal_notes=b,re(a).then(y=>{y.status==200&&y.json().then(A=>{C(!0),g(A),f(A.internal_notes)})}))},G=y=>{if(y.claimed_at){const A=new Date(y.claimed_at);return Math.round(Math.abs((A.getTime()-new Date().getTime())/864e5))}return 0};return o(O,{children:[o(R,{open:t.open,onClose:t.handleClose,scroll:"body",children:[e(z,{children:"Group"}),a?o(O,{children:[e(N,{children:o(P,{children:["Group ID: ",t.groupId]})}),e(N,{children:o(P,{sx:{"& button":{m:1}},children:["Owner:"," ",e(Z,{to:"/attendees/"+a.owner.id,children:a.owner.nickname+(a.owner.fully_paid?" (Paid)":" (Not paid)")}),e(w,{size:"small",variant:"contained",color:"error",onClick:j,children:"Disband Group"})]})}),a.users.filter(y=>y.id!==a.owner.id).map((y,A)=>e(N,{children:o(P,{sx:{"& button":{m:1}},children:[e(Z,{to:"/attendees/"+y.id,children:y.nickname+(y.fully_paid?" (Paid)":" (Not paid)")}),e(w,{size:"small",variant:"contained",color:"error",onClick:()=>l(y.id),children:"Remove from group"}),e(w,{size:"small",variant:"contained",color:"primary",onClick:()=>E(y.id),children:"Make group owner"})]})},A)),e(N,{children:o(D,{children:[e(v,{multiline:!0,rows:4,name:"internal_notes",label:"Internal Notes",value:b||"",onChange:m,fullWidth:!0,variant:"standard",margin:"dense"}),e(w,{color:h?"success":"primary",onClick:T,children:h?"Saved!":"Save internal notes"})]})}),e(N,{children:a.accommodation?o(P,{children:["Accommodation:"," ",e(Z,{to:"/accommodation/"+a.accommodation.id,children:a.accommodation.name}),e("br",{}),"Claimed ",G(a)," days ago"]}):e(P,{children:"Group has no accommodation"})}),e(H,{children:e(w,{onClick:t.handleClose,children:"Close"})})]}):null]}),e(R,{open:!!n,onClose:_,children:a?o(O,{children:[e(z,{children:"Remove from group"}),e(N,{children:e(P,{children:"Are you sure?"})}),o(H,{children:[e(w,{onClick:_,children:"Close"}),e(w,{onClick:S,children:"Remove from group"})]})]}):null}),e(R,{open:p,onClose:r,children:a?o(O,{children:[e(z,{children:"Disband group"}),e(N,{children:e(P,{children:"Are you sure?"})}),o(H,{children:[e(w,{onClick:r,children:"Close"}),e(w,{onClick:c,children:"Disband group"})]})]}):null})]})}function pe(){const t=K(),{id:i}=ie(),[a,g]=d.exports.useState(""),[n,s]=d.exports.useState([]),[p,u]=d.exports.useState("");d.exports.useEffect(()=>{we().then(r=>{r.status==200?r.json().then(c=>{console.log(c),s(c.results)}):r.status==401?(t(k("/")),t(L()),localStorage.removeItem("TOKEN")):r.json().then(c=>{g("Error while retrieving groups.  Please try again or contact tech."),console.log(c)})})},[]);const b=r=>{t(k("/groups/"+r.id))},f=()=>{t(k("/groups"))},h=r=>{u(r.target.value)},C=r=>r.accommodation&&r.accommodation.name.toLowerCase().includes(p.toLowerCase())||r.owner.nickname.toLowerCase().includes(p.toLowerCase()),l=r=>{for(const c of r.users)if(!c.fully_paid)return!0;return!1},_=r=>{s(n.filter(c=>r.id!==c.id))},S=r=>{if(r.claimed_at){const c=new Date(r.claimed_at);return Math.round(Math.abs((c.getTime()-new Date().getTime())/864e5))}return 0},j=r=>r.accommodation?l(r)?" (Unpaid for "+S(r)+" days)":" (Paid)":"";return o(O,{children:[a?e(Q,{severity:"error",children:a}):null,e(v,{fullWidth:!0,id:"outlined-basic",label:"Search",variant:"outlined",onChange:h}),e(ee,{children:n.filter(r=>C(r)).map((r,c)=>e(F,{children:o(J,{onClick:()=>b(r),children:[e(V,{children:e(B,{children:e(fe,{})})}),e(q,{primary:r.owner.nickname+"'s group",secondary:r.users.length+" member(s)"+j(r)})]})},c))}),i?e(Mt,{open:!0,handleClose:f,groupId:i,handleDeleted:_}):null]})}function Rt(){const t=K(),[i,a]=d.exports.useState(""),[g,n]=d.exports.useState([]),[s,p]=d.exports.useState(-1);d.exports.useEffect(()=>{jt().then(h=>{h.status==200?h.json().then(C=>{n(C.results)}):h.status==401?(t(k("/")),t(L()),localStorage.removeItem("TOKEN")):h.json().then(C=>{a("Error while retrieving config.  Please try again or contact tech."),console.log(C)})})},[]);const u=h=>{g[parseInt(h.target.name)].value=h.target.value,n([...g])},b=h=>{Gt(g[h]).then(C=>{C.status==200?p(h):C.json().then(l=>{a("Error while retrieving config.  Please try again or contact tech."),console.log(l)})})},f={SIGNUP_MODE:"Current signup page restriction.  Set to 0 for signup closed, 1 for staff-only and 2 for signup open.",RECAPTCHA_MIN_SCORE:"Minimum required ReCAPTCHA assessment score, 0 is fail, 1 is success.  If in doubt, set to 0.3",INTRO_TEXT:"Message displayed on the registration site homepage.",CLAIM_MODE:"Current accommodation claim restriction.  Set to 0 for claim unavailable, 1 for staff-only and 2 for open to all.",SPONSOR_PRICE:"The price to sponsor in pence.",STAFF_DISCOUNT:"The discount staff receive in pence.",LODGE_EXTRA_DAYS:"The price in pence for extra days for lodges as JSON array of 8 prices.  Enter just null for no price.",EXTRA_DAYS:"The price in pence for extra days as JSON array of 8 prices.  Enter just null for no price."};return o(D,{direction:"column",spacing:2,children:[i?e(Q,{severity:"error",children:i}):null,g.map((h,C)=>o(D,{direction:"row",alignItems:"center",spacing:2,children:[e(X,{children:h.id}),e(v,{name:""+C,label:"Value",multiline:!0,maxRows:4,value:h.value,onChange:u}),e(X,{width:400,children:f[h.id]}),e(w,{variant:"contained",color:s==C?"success":"primary",onClick:()=>b(C),children:s==C?"Saved!":"Save"})]},C))]})}function zt(t){const i=K(),[a,g]=d.exports.useState(!1),[n,s]=d.exports.useState(),p=Ce.createRef();d.exports.useEffect(()=>{t.isNew?s({id:"",name:"",min_capacity:1,max_capacity:2,availability:0,prices:[null,null,null,null,null,null,null,null],is_lodge:!1,internal_notes:""}):Ot(t.accommodationId).then(r=>{r.status==200?r.json().then(c=>{s(c)}):r.status==401&&(i(k("/")),i(L()),localStorage.removeItem("TOKEN"))})},[]);const u=r=>{n&&s(W(I({},n),{[r.target.name]:r.target.value}))},b=r=>{if(n){const c=[...n.prices];for(let E=0;E<8;E++)(E+1<n.min_capacity||E+1>n.max_capacity)&&(c[E]=null);s(W(I({},n),{prices:c,[r.target.name]:r.target.value}))}},f=r=>{n&&s(W(I({},n),{[r.target.name]:r.target.checked}))},h=r=>{if(n){const c=parseInt(r.target.name.substring(r.target.name.indexOf("_")+1)),E=[...n.prices];E[c-1]=parseInt(r.target.value),s(W(I({},n),{prices:E}))}},C=()=>{g(!0)},l=()=>{g(!1)},_=()=>{n&&At(n).then(r=>{r.status==204&&(t.handleDeleted(n),i(k("/accommodation")))})},S=()=>{n&&p.current&&p.current.reportValidity()&&(t.isNew?It(n):Et(n)).then(c=>{(c.status==200||c.status==201)&&(t.handleUpdated(),i(k("/accommodation")))})},j=()=>{n&&n.id&&navigator.clipboard.writeText(n.id)};return o(O,{children:[o(R,{open:t.open,onClose:t.handleClose,scroll:"body",children:[o(D,{direction:"row",alignItems:"center",minWidth:"558px",children:[o(z,{children:[t.isNew?"Create ":null,"Accommodation"]}),n&&!t.isNew?o(P,{children:["ID: ",n.id,e(nt,{title:"Copy",children:e(te,{"aria-label":"copy",onClick:j,children:e(at,{})})})]}):null]}),n?o(O,{children:[e(N,{children:o(D,{component:"form",ref:p,spacing:2,children:[e(v,{name:"name",onChange:u,label:"Accommodation Name",value:n.name,required:!0}),e($,{control:e(U,{name:"is_lodge",checked:n.is_lodge,onChange:f}),label:"Is lodge?"}),o(D,{direction:"row",spacing:2,alignItems:"center",justifyContent:"left",children:[e(v,{fullWidth:!0,required:!0,name:"min_capacity",onChange:b,label:"Minimum Occupancy",type:"number",inputProps:{inputMode:"numeric",pattern:"[0-9]*",min:1,max:8},value:n.min_capacity}),e(v,{fullWidth:!0,required:!0,name:"max_capacity",onChange:b,label:"Maximum Occupancy",type:"number",inputProps:{inputMode:"numeric",pattern:"[0-9]*",min:1,max:8},value:n.max_capacity}),e(v,{fullWidth:!0,required:!0,name:"availability",onChange:u,label:"Availability",type:"number",inputProps:{inputMode:"numeric",pattern:"[0-9]*"},value:n.availability})]}),e(D,{direction:"row",children:e(de,{container:!0,spacing:2,children:n.prices.map((r,c)=>c+1>=(n.min_capacity||1)&&c+1<=(n.max_capacity||8)&&c+1>=1&&c+1<=8?e(de,{item:!0,xs:6,children:e(v,{fullWidth:!0,required:!0,label:"Price for "+(c+1),name:"price_"+(c+1),value:r||"",onChange:h,type:"number",InputProps:{endAdornment:e(ae,{position:"end",children:"p"})}})},c):null)})}),e(v,{fullWidth:!0,name:"internal_notes",onChange:u,label:"Internal Notes",value:n.internal_notes,multiline:!0})]})}),o(H,{children:[t.isNew?e(O,{children:e(w,{onClick:S,children:"Create"})}):o(O,{children:[e(w,{onClick:S,children:"Save"}),e(w,{color:"error",onClick:C,children:"Delete"})]}),e(w,{onClick:t.handleClose,children:"Close"})]})]}):null]}),e(R,{open:a,onClose:l,children:n&&!t.isNew?o(O,{children:[e(z,{children:"Delete Accommodation"}),e(N,{children:e(P,{children:"Are you sure?"})}),o(H,{children:[e(w,{onClick:l,children:"Close"}),e(w,{onClick:_,children:"Delete"})]})]}):null})]})}function ge(){const t=K(),{id:i}=ie(),[a,g]=d.exports.useState(""),[n,s]=d.exports.useState([]),[p,u]=d.exports.useState("");d.exports.useEffect(()=>{b()},[]);const b=()=>{xt().then(r=>{r.status==200?r.json().then(c=>{s(c.results)}):r.status==401?(t(k("/")),t(L()),localStorage.removeItem("TOKEN")):r.json().then(c=>{g("Error while retrieving groups.  Please try again or contact tech."),console.log(c)})})},f=r=>{t(k("/accommodation/"+r.id))},h=()=>{t(k("/accommodation/new"))},C=()=>{t(k("/accommodation"))},l=r=>{u(r.target.value)},_=r=>r.toLowerCase().includes(p.toLowerCase()),S=r=>{s(n.filter(c=>r.id!==c.id))},j=()=>{b()};return o(O,{children:[a?e(Q,{severity:"error",children:a}):null,e(v,{fullWidth:!0,id:"outlined-basic",label:"Search",variant:"outlined",onChange:l}),o(ee,{children:[e(F,{children:o(J,{onClick:()=>h(),children:[e(V,{children:e(B,{children:e(ue,{})})}),e(q,{primary:"Create New"})]})}),n.filter(r=>_(r.name)).map((r,c)=>e(F,{children:o(J,{onClick:()=>f(r),children:[e(V,{children:e(B,{children:e(ne,{})})}),e(q,{primary:r.name,secondary:o(D,{direction:"row",spacing:4,alignItems:"center",justifyContent:"left",children:[o(D,{direction:"row",spacing:1,alignItems:"center",children:[e(rt,{}),o("span",{children:[r.min_capacity,"-",r.max_capacity]})]}),o(D,{direction:"row",spacing:1,alignItems:"center",children:[e(ne,{}),e("span",{children:r.availability+" ("+(r.availability-r.occupied)+" remaining)"})]})]})})]})},c)),e(F,{children:o(J,{onClick:()=>h(),children:[e(V,{children:e(B,{children:e(ue,{})})}),e(q,{primary:"Create New"})]})})]}),i?e(zt,{open:!0,handleClose:C,accommodationId:i,handleDeleted:S,handleUpdated:j,isNew:i=="new"}):null]})}ot.render(e(Ce.StrictMode,{children:e(it,{store:ve,children:e(ht,{children:e(lt,{history:bt,children:o(st,{children:[e(M,{path:"/",element:e(Lt,{})}),e(M,{path:"/accommodation",element:e(ge,{})}),e(M,{path:"/accommodation/:id",element:e(ge,{})}),e(M,{path:"/attendees",element:e(me,{})}),e(M,{path:"/attendees/:id",element:e(me,{})}),e(M,{path:"/groups",element:e(pe,{})}),e(M,{path:"/groups/:id",element:e(pe,{})}),e(M,{path:"/config",element:e(Rt,{})})]})})})})}),document.getElementById("root"));

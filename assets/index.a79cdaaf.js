var $e=Object.defineProperty,qe=Object.defineProperties;var Je=Object.getOwnPropertyDescriptors;var Te=Object.getOwnPropertySymbols;var Ve=Object.prototype.hasOwnProperty,Ye=Object.prototype.propertyIsEnumerable;var Oe=(t,r,a)=>r in t?$e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,O=(t,r)=>{for(var a in r||(r={}))Ve.call(r,a)&&Oe(t,a,r[a]);if(Te)for(var a of Te(r))Ye.call(r,a)&&Oe(t,a,r[a]);return t},H=(t,r)=>qe(t,Je(r));import{u as Xe,a as Ze,s as we,M as Qe,c as et,r as u,j as i,T as tt,b as e,C as nt,B as at,d as rt,I as se,e as ot,f as te,D as it,g as lt,h as st,i as ct,L as pe,k as Z,l as dt,m as Q,n as Ie,o as be,p as ut,q as Ge,t as ht,v as k,w as Re,x as mt,y as gt,z as pt,F as T,A as de,P as ft,S as R,E as v,G as z,H as F,J as I,K as B,N as U,O as M,Q as D,R as x,U as Ct,V as yt,W as _t,X as ae,Y as re,Z as J,_ as Se,$ as ge,a0 as vt,a1 as ke,a2 as X,a3 as We,a4 as ie,a5 as le,a6 as ee,a7 as bt,a8 as Ke,a9 as St,aa as xt,ab as Ee,ac as Ne,ad as wt,ae as kt,af as At,ag as Tt,ah as Ot,ai as $}from"./vendor.3962a6c3.js";const It=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))g(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const m of c.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&g(m)}).observe(document,{childList:!0,subtree:!0});function a(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function g(n){if(n.ep)return;n.ep=!0;const c=a(n);fetch(n.href,c)}};It();const K=()=>Xe(),V=Ze,ce=240,Et=we("main",{shouldForwardProp:t=>t!=="open"})(({theme:t,open:r})=>O({flexGrow:1,padding:t.spacing(3),transition:t.transitions.create("margin",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),marginLeft:`-${ce}px`},r&&{transition:t.transitions.create("margin",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen}),marginLeft:0})),Nt=we(Qe,{shouldForwardProp:t=>t!=="open"})(({theme:t,open:r})=>O({transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},r&&{width:`calc(100% - ${ce}px)`,marginLeft:`${ce}px`,transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen})})),De=we("div")(({theme:t})=>H(O({display:"flex",alignItems:"center",padding:t.spacing(0,1)},t.mixins.toolbar),{justifyContent:"flex-end"}));function Dt(t){const r=K(),a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,g=et({palette:{mode:a?"dark":"light"}}),[n,c]=u.exports.useState(!0),m=V(w=>w.user.authed),h=()=>{c(!0)},_=()=>{c(!1)};let C;m?C={"/":{label:"Intro",icon:e(Ie,{})},"/accommodation":{label:"Accommodation",icon:e(be,{})},"/attendees":{label:"Attendees",icon:e(ut,{})},"/groups":{label:"Groups",icon:e(Ge,{})},"/config":{label:"Config",icon:e(ht,{})}}:C={"/":{label:"Intro",icon:e(Ie,{})}};const f="/"+window.location.pathname.split("/")[1],[b,E]=u.exports.useState(C[f].label),P=w=>{const j=C[w];E(j.label),r(k(w))};return i(tt,{theme:g,children:[e(nt,{}),i(at,{sx:{display:"flex"},children:[e(Nt,{position:"fixed",open:n,children:i(rt,{children:[e(se,{color:"inherit","aria-label":"open drawer",onClick:h,edge:"start",sx:O({mr:2},n&&{display:"none"}),children:e(ot,{})}),e(te,{variant:"h6",noWrap:!0,component:"div",children:b})]})}),i(it,{sx:{width:ce,flexShrink:0,"& .MuiDrawer-paper":{width:ce,boxSizing:"border-box"}},variant:"persistent",anchor:"left",open:n,children:[e(De,{children:e(se,{onClick:_,children:g.direction==="ltr"?e(lt,{}):e(st,{})})}),e(ct,{}),e(pe,{children:Object.keys(C).map(w=>i(Z,{button:!0,onClick:()=>P(w),children:[e(dt,{children:C[w].icon}),e(Q,{primary:C[w].label})]},w))})]}),i(Et,{open:n,children:[e(De,{}),t.children]})]})]})}const Pt={authed:!!localStorage.getItem("TOKEN")},ze=Re({name:"user",initialState:Pt,reducers:{login(t){t.authed=!0},logout(t){t.authed=!1}}}),{login:jt,logout:W}=ze.actions;var Lt=ze.reducer;const Gt={config:{}},Fe=Re({name:"config",initialState:Gt,reducers:{setConfig(t,r){t.config=r.payload}}}),{setConfig:Rt}=Fe.actions;var Wt=Fe.reducer;const{createReduxHistory:Kt,routerMiddleware:zt,routerReducer:Ft}=mt({history:gt()}),Ae=pt({reducer:{router:Ft,user:Lt,config:Wt},middleware:[zt]}),Mt=Kt(Ae),A=window.location.hostname=="localhost"?"http://localhost:8000/":"https://api.reg.furcation.org.uk/",Ht=window.location.protocol+"//"+window.location.host;function Bt(){return fetch(A+"auth/o/keycloak/?"+new URLSearchParams({redirect_uri:Ht}),{method:"GET",credentials:"include"})}function Ut(t,r){return fetch(A+"auth/o/keycloak/",{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({state:t,code:r})})}function $t(){return fetch(A+"auth/users/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function qt(t){return fetch(A+"auth/users/"+t,{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Jt(t){return fetch(A+"auth/users/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function Me(){return fetch(A+"accommodation/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Vt(t){return fetch(A+"accommodation/"+t+"/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Yt(t){return fetch(A+"accommodation/",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function Xt(t){return fetch(A+"accommodation/"+t.id+"/",{method:"DELETE",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Zt(t){return fetch(A+"accommodation/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function He(){return fetch(A+"groups/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function xe(t){return fetch(A+"groups/"+t+"/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Qt(t){return fetch(A+"groups/"+t.id+"/",{method:"DELETE",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function en(t){return fetch(A+"auth/users/"+t.id+"/",{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")}})}function tn(t,r){return fetch(A+"groups/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify({owner:{id:r,nickname:""}})})}function oe(t){return fetch(A+"groups/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function Be(){return fetch(A+"config/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function nn(t){return fetch(A+"config/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify({value:t.value})})}function an(){const t=K(),r=V(m=>m.user.authed),[a,g]=u.exports.useState("");return u.exports.useEffect(()=>{const m=new URLSearchParams(window.location.search),h=m.get("state"),_=m.get("code");!r&&h&&_&&Ut(h,_).then(C=>{C.status==201?C.json().then(f=>{localStorage.setItem("TOKEN",f.access),t(jt())}):C.json().then(f=>{g("Login flow expired, please login again."),console.log(f)})})},[]),i(T,{children:[a?e(de,{severity:"error",children:a}):null,i(ft,{variant:"outlined",sx:{my:{xs:3,md:6},p:{xs:2,md:3}},children:[e(te,{variant:"h6",color:"inherit",children:"Welcome to Furcation Registation Admin Panel"}),i(te,{variant:"body1",color:"inherit",paragraph:!0,children:["Welcome to the admin panel here you can view and edit attendees and groups for maintainance or resolving issues. For any issues please contact us:",e("br",{}),e("br",{}),"Registration - reg@furcation.org.uk",e("br",{}),"IT - it@furcation.org.uk"]}),r?e(R,{spacing:2,alignItems:"center",children:e(v,{color:"error",variant:"contained",sx:{minWidth:{sm:400,xs:"100%"}},onClick:()=>{t(W()),localStorage.removeItem("TOKEN")},children:"Logout"})}):e(R,{spacing:2,alignItems:"center",children:e(v,{variant:"contained",sx:{minWidth:{sm:400,xs:"100%"}},onClick:()=>{Bt().then(m=>{m.status==200?m.json().then(h=>{window.location.href=h.authorization_url}):m.json().then(h=>{g("Error while contacting Keycloak, please try again or contact tech."),console.log(h)})})},children:"Login with Keycloak"})})]})]})}function rn(t){const r=K(),[a,g]=u.exports.useState([]),[n,c]=u.exports.useState("");u.exports.useEffect(()=>{He().then(h=>{h.status==200?h.json().then(_=>{g(_.results.filter(C=>C.users.length<8)),c("0")}):h.status==401&&(r(k("/")),r(W()),localStorage.removeItem("TOKEN"))})},[]);const m=h=>{c(h.target.value)};return i(z,{open:t.open,onClose:()=>t.handleClose(null),children:[e(F,{children:"Pick a group"}),a?i(T,{children:[e(I,{children:e(B,{value:n,label:"Group",fullWidth:!0,variant:"standard",margin:"dense",onChange:m,children:a.map((h,_)=>i(U,{value:_,children:[h.owner.nickname,"'s Group"]},_))})}),i(M,{children:[e(v,{onClick:()=>t.handleClose(null),children:"Close"}),e(v,{onClick:()=>t.handleClose(a[parseInt(n)]),children:"Confirm"})]})]}):null]})}function on(t){const r=K(),[a,g]=u.exports.useState({}),[n,c]=u.exports.useState(null),[m,h]=u.exports.useState(null),[_,C]=u.exports.useState("1990-01-01"),[f,b]=u.exports.useState(0),[E,P]=u.exports.useState(!1),[w,j]=u.exports.useState(!1);u.exports.useEffect(()=>{qt(t.userId).then(s=>{s.status==200?s.json().then(S=>{c(S),C(S.date_of_birth),S.group&&xe(S.group).then(N=>{N.status==200&&N.json().then(q=>{h(q)})})}):s.status==401?(r(k("/")),r(W()),localStorage.removeItem("TOKEN")):s.json().then(S=>{g(S)})})},[]);const o=JSON.parse(V(s=>s.config.config.HOODIE_SIZES||"[]")),d=JSON.parse(V(s=>s.config.config.EXTRA_DAYS||"[]")),L=JSON.parse(V(s=>s.config.config.LODGE_EXTRA_DAYS||"[]")),l=JSON.parse(V(s=>s.config.config.SPONSOR_PRICE||"[]")),y=JSON.parse(V(s=>s.config.config.STAFF_DISCOUNT||"[]")),ue=()=>{let s=0;if(n&&m&&m.accommodation){s=m.accommodation.prices[m.users.length-1]||0;const S=m.accommodation.is_lodge?L:d;n.email.endsWith("@furcation.org.uk")&&(s-=y);let N=0,q=0;m.users.map(me=>{me.is_early&&(N+=1),me.is_late&&(q+=1)}),n.is_early&&(s+=S[N-1]),n.is_late&&(s+=S[q-1]),n.is_sponsor&&(s+=l),s+=Number(n.adjustments)}return s},G=s=>{n&&(n[s.target.name]=s.target.value,c(O({},n)))},fe=()=>{j(!0)},Ce=()=>{n&&en(n).then(s=>{s.status==204&&(t.handleDeleted(n),t.handleClose())})},Y=s=>{n&&(n[s.target.name]=s.target.checked,c(O({},n)))},ye=s=>{n&&(n.hoodie_size=s.target.value,c(O({},n)))},ne=s=>{const S=new Date(s),N=S.getFullYear()+"-"+("0"+(S.getMonth()+1)).slice(-2)+"-"+("0"+S.getDate()).slice(-2);C(N),n&&(n.date_of_birth=N)},_e=()=>{if(n){b(1);const s=O({},n);s.phone_number=he(s.phone_number),s.ice_phone=he(s.ice_phone),delete s.group,Jt(s).then(S=>{console.log(S.status),S.status==200?S.json().then(N=>{b(2),c(N),C(N.date_of_birth),N.group&&xe(N.group).then(q=>{q.status==200&&q.json().then(me=>{h(me)})})}):S.status==401?(r(k("/")),r(W()),localStorage.removeItem("TOKEN")):S.status==400&&(b(0),S.json().then(N=>{console.log(N),g(N)}))})}},he=s=>(s=s.replaceAll(" ",""),s.charAt(0)==="0"?"+44"+s.substring(1):s),ve=()=>{P(!0)},p=s=>{n&&s&&(s.users.push({id:n.id,nickname:n.nickname,fully_paid:!1,is_early:!1,is_late:!1}),oe(s).then(S=>{S.status==200&&(c(H(O({},n),{group:s})),h(s))})),P(!1)};return i(T,{children:[i(z,{open:t.open,onClose:t.handleClose,scroll:"body",children:[e(F,{children:"Attendee "}),n?i(T,{children:[i(I,{children:[i(D,{children:["Badge Number:"," ",n.badge_override?n.badge_override+" (Overridden from "+n.id+")":n.id]}),e(x,{required:!0,name:"full_name",label:"Full (Legal) Name",value:n.full_name,onChange:G,autoComplete:"fullname",error:Object.prototype.hasOwnProperty.call(a,"full_name"),helperText:a.full_name,fullWidth:!0,variant:"standard",margin:"dense"}),e(x,{required:!0,name:"nickname",label:"Badge Name (Nickname/Furry Name)",value:n.nickname,onChange:G,autoComplete:"nickname",error:Object.prototype.hasOwnProperty.call(a,"nickname"),helperText:a.nickname,fullWidth:!0,variant:"standard",margin:"dense"}),e(x,{required:!0,name:"email",label:"Email",value:n.email,onChange:G,autoComplete:"email",error:Object.prototype.hasOwnProperty.call(a,"email"),helperText:a.email,fullWidth:!0,variant:"standard",margin:"dense"}),e(Ct,{dateAdapter:yt,children:e(_t,{label:"Date of Birth",value:_,onChange:ne,inputFormat:"yyyy-MM-dd",mask:"____-__-__",renderInput:s=>e(x,H(O({},s),{required:!0,error:Object.prototype.hasOwnProperty.call(a,"date_of_birth"),helperText:a.date_of_birth,fullWidth:!0,variant:"standard",margin:"dense"}))})}),e(x,{required:!0,multiline:!0,rows:4,name:"address",label:"Address",value:n.address,onChange:G,error:Object.prototype.hasOwnProperty.call(a,"address"),helperText:a.address,fullWidth:!0,variant:"standard",margin:"dense"}),e(x,{required:!0,type:"tel",name:"phone_number",label:"Phone Number",autoComplete:"phone",value:n.phone_number,onChange:G,error:Object.prototype.hasOwnProperty.call(a,"phone_number"),helperText:a.phone_number,fullWidth:!0,variant:"standard",margin:"dense"}),e(x,{multiline:!0,rows:4,name:"medical_details",label:"Any medical details we should know? (optional)",value:n.medical_details||"",onChange:G,error:Object.prototype.hasOwnProperty.call(a,"medical_details"),helperText:a.medical_details,fullWidth:!0,variant:"standard",margin:"dense"}),e(x,{required:!0,name:"ice_name",label:"ICE Name",value:n.ice_name,onChange:G,autoComplete:"ice_name",error:Object.prototype.hasOwnProperty.call(a,"ice_name"),helperText:a.ice_name,fullWidth:!0,variant:"standard",margin:"dense"}),e(x,{required:!0,name:"ice_phone",label:"ICE Phone",value:n.ice_phone,onChange:G,autoComplete:"ice_phone",error:Object.prototype.hasOwnProperty.call(a,"ice_phone"),helperText:a.ice_phone,fullWidth:!0,variant:"standard",margin:"dense"}),e(ae,{control:e(re,{name:"is_fursuiter",checked:n.is_fursuiter,onChange:Y}),label:"Fursuiter"}),e(ae,{control:e(re,{name:"is_early",checked:n.is_early,onChange:Y}),label:"Early"}),e(ae,{control:e(re,{name:"is_late",checked:n.is_late,onChange:Y}),label:"Late"}),e(ae,{control:e(re,{name:"is_sponsor",checked:n.is_sponsor,onChange:Y}),label:"Sponsor"}),e(J,{shrink:!0,children:"Hoodie Size"}),e(B,{value:n.hoodie_size,fullWidth:!0,variant:"standard",margin:"dense",label:"Hoodie Size",onChange:ye,children:o.map(s=>e(U,{value:s,children:e(te,{color:"text.primary",children:s})},s))}),e(x,{name:"badge_override",label:"Badge Number Override",value:n.badge_override,onChange:G,autoComplete:"badge_override",error:Object.prototype.hasOwnProperty.call(a,"badge_override"),helperText:a.badge_override,fullWidth:!0,variant:"standard",margin:"dense"}),e(x,{name:"paid",label:"Amount paid",value:n.paid,onChange:G,autoComplete:"paid",type:"number",error:Object.prototype.hasOwnProperty.call(a,"paid"),InputProps:{endAdornment:e(Se,{position:"end",children:"p"})},helperText:a.paid,fullWidth:!0,variant:"standard",margin:"dense"}),e(x,{name:"adjustments",label:"Bill adjustments",value:n.adjustments,onChange:G,autoComplete:"adjustments",type:"number",error:Object.prototype.hasOwnProperty.call(a,"adjustments"),InputProps:{endAdornment:e(Se,{position:"end",children:"p"})},helperText:a.adjustments,fullWidth:!0,variant:"standard",margin:"dense"})]}),e(I,{children:i(D,{children:["Total Bill: \xA3",(ue()/100).toFixed(2)]})}),e(I,{children:i(D,{children:["Left to pay: \xA3",((ue()-n.paid)/100).toFixed(2)]})}),e(I,{children:e(x,{multiline:!0,rows:4,name:"internal_notes",label:"Internal Notes",value:n.internal_notes||"",onChange:G,error:Object.prototype.hasOwnProperty.call(a,"internal_notes"),helperText:a.internal_notes,fullWidth:!0,variant:"standard",margin:"dense"})}),e(I,{children:m?i(D,{children:["Group:"," ",i(ge,{to:"/groups/"+m.id,children:[m.owner.nickname,"'s Group"]})]}):i(D,{sx:{"& button":{m:1}},children:["No group",e(v,{size:"small",variant:"contained",color:"primary",onClick:ve,children:"Add to a group"})]})}),i(M,{children:[e(v,{onClick:t.handleClose,children:"Close"}),e(v,{color:"error",onClick:fe,children:"Delete"}),e(vt,{loading:f==1,color:f==2?"success":"primary",onClick:_e,children:f==2?"Saved!":"Save Changes"})]})]}):null]}),E?e(rn,{open:!0,handleClose:p}):null,i(z,{open:w,onClose:t.handleClose,children:[e(F,{children:"Delete Attendee"}),e(I,{children:e(D,{children:"Are you sure you want to delete this attendee?"})}),i(M,{children:[e(v,{onClick:t.handleClose,children:"Cancel"}),e(v,{onClick:Ce,color:"error",variant:"contained",children:"Delete"})]})]})]})}function Ue(t){const r=u.exports.createRef();return e(T,{children:e("a",{role:"button",ref:r,onClick:async()=>{if(r&&r.current&&r.current.href)return;const n=await(await fetch(t.url,{headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})).blob(),c=window.URL.createObjectURL(n);r&&r.current&&(r.current.download=t.filename,r.current.href=c,r.current.click())},children:t.children})})}function Pe(){const t=K(),r=["Not Filtered","Yes","No"],{id:a}=ke(),[g,n]=u.exports.useState(""),[c,m]=u.exports.useState({is_early:"Not Filtered",is_late:"Not Filtered",is_sponsor:"Not Filtered",is_active:"Yes",is_staff:"Not Filtered",is_admin:"No"}),[h,_]=u.exports.useState([]),[C,f]=u.exports.useState("");u.exports.useEffect(()=>{b()},[]);const b=()=>{$t().then(l=>{l.status==200?l.json().then(y=>{_(y.results)}):l.status==401?(t(k("/")),t(W()),localStorage.removeItem("TOKEN")):l.json().then(()=>{n("Error while retrieving attendees.  Please try again or contact tech.")})})},E=l=>{_(h.filter(()=>l.id!==l.id))},P=l=>{t(k("/attendees/"+l.id))},w=()=>{t(k("/attendees")),b()},j=l=>{f(l.target.value)},o=l=>{console.log(l.target.name+": "+l.target.value),c[l.target.name]=l.target.value,m(O({},c))},d=l=>l.toLowerCase().includes(C.toLowerCase()),L=l=>{let y=!0;return y=c.is_early==r[0]?y:c.is_early==r[1]?y&&l.is_early:y&&!l.is_early,y=c.is_late==r[0]?y:c.is_late==r[1]?y&&l.is_late:y&&!l.is_late,y=c.is_sponsor==r[0]?y:c.is_sponsor==r[1]?y&&l.is_sponsor:y&&!l.is_sponsor,y=c.is_staff==r[0]?y:c.is_staff==r[1]?y&&l.email.endsWith("@furcation.org.uk"):y&&!l.email.endsWith("@furcation.org.uk"),y=c.is_active==r[0]?y:c.is_active==r[1]?y&&l.is_active:y&&!l.is_active,y=c.is_admin==r[0]?y:c.is_admin==r[1]?y&&l.is_staff:y&&!l.is_staff,y};return i(T,{children:[g?e(de,{severity:"error",children:g}):null,e(x,{fullWidth:!0,id:"outlined-basic",label:"Search",variant:"outlined",onChange:j}),i(X,{sx:{width:"20ch",p:{xs:2,md:3}},children:[e(J,{sx:{p:{xs:3,md:4}},children:"Early"}),e(B,{value:c.is_early,label:"Early",name:"is_early",onChange:o,children:r.map(l=>e(U,{value:l,children:l},l))})]}),i(X,{sx:{width:"20ch",p:{xs:2,md:3}},children:[e(J,{sx:{p:{xs:3,md:4}},children:"Late"}),e(B,{value:c.is_late,label:"Late",name:"is_late",onChange:o,children:r.map(l=>e(U,{value:l,children:l},l))})]}),i(X,{sx:{width:"20ch",p:{xs:2,md:3}},children:[e(J,{sx:{p:{xs:3,md:4}},children:"Sponsor"}),e(B,{value:c.is_sponsor,label:"Sponsor",name:"is_sponsor",onChange:o,children:r.map(l=>e(U,{value:l,children:l},l))})]}),i(X,{sx:{width:"20ch",p:{xs:2,md:3}},children:[e(J,{sx:{p:{xs:3,md:4}},children:"Active"}),e(B,{value:c.is_active,label:"Active",name:"is_active",onChange:o,children:r.map(l=>e(U,{value:l,children:l},l))})]}),i(X,{sx:{width:"20ch",p:{xs:2,md:3}},children:[e(J,{sx:{p:{xs:3,md:4}},children:"Staff"}),e(B,{value:c.is_staff,label:"Staff",name:"is_staff",onChange:o,children:r.map(l=>e(U,{value:l,children:l},l))})]}),i(X,{sx:{width:"20ch",p:{xs:2,md:3}},children:[e(J,{sx:{p:{xs:3,md:4}},children:"Admin"}),e(B,{value:c.is_admin,label:"Admin",name:"is_admin",onChange:o,children:r.map(l=>e(U,{value:l,children:l},l))})]}),e(Ue,{url:A+"auth/users.csv",filename:"users.csv",children:e(se,{"aria-label":"download",sx:{p:{xs:4,md:5}},children:e(We,{})})}),e(pe,{children:h.filter(l=>(d(l.full_name)||d(l.nickname)||d(l.email)||d(l.id+"")||d(l.badge_override))&&L(l)).map((l,y)=>e(Z,{children:i(ie,{onClick:()=>P(l),children:[e(le,{children:l.badge_image?e(ee,{src:"https://storage.googleapis.com/reggie-badges/"+l.badge_image}):e(ee,{children:e(bt,{})})}),e(Q,{primary:l.nickname,secondary:l.full_name+" - "+l.email+" - #"+(l.badge_override?l.badge_override+" (Overridden from "+l.id+")":l.id)})]})},y))}),a?e(on,{open:!0,handleClose:w,userId:a,handleDeleted:E}):null]})}function ln(t){const r=K(),[a,g]=u.exports.useState([]),[n,c]=u.exports.useState("");u.exports.useEffect(()=>{Me().then(h=>{h.status==200?h.json().then(_=>{g(_.results.filter(C=>C.min_capacity<=t.groupSize&&C.max_capacity>=t.groupSize)),c("0")}):h.status==401&&(r(k("/")),r(W()),localStorage.removeItem("TOKEN"))})},[]);const m=h=>{c(h.target.value)};return i(z,{open:t.open,onClose:()=>t.handleClose(null),children:[e(F,{children:"Pick accommodation"}),a?i(T,{children:[e(I,{children:e(B,{value:n,label:"Accommodation",fullWidth:!0,variant:"standard",margin:"dense",onChange:m,children:a.map((h,_)=>e(U,{value:_,children:h.name},_))})}),i(M,{children:[e(v,{onClick:()=>t.handleClose(null),children:"Close"}),e(v,{onClick:()=>t.handleClose(a[parseInt(n)]),children:"Confirm"})]})]}):null]})}function sn(t){const r=K(),[a,g]=u.exports.useState(null),[n,c]=u.exports.useState(0),[m,h]=u.exports.useState(!1),[_,C]=u.exports.useState(""),[f,b]=u.exports.useState(!1),[E,P]=u.exports.useState(!1),[w,j]=u.exports.useState(!1);u.exports.useEffect(()=>{xe(t.groupId).then(p=>{p.status==200?p.json().then(s=>{g(s),C(s.internal_notes)}):p.status==401&&(r(k("/")),r(W()),localStorage.removeItem("TOKEN"))})},[]);const o=p=>{c(p)},d=()=>{c(0)},L=()=>{a&&(a.users=a.users.filter(p=>p.id!==n),oe(a).then(p=>{p.status==200&&p.json().then(s=>{g(s),c(0)})}))},l=()=>{h(!0)},y=()=>{h(!1)},ue=()=>{a&&Qt(a).then(p=>{p.status==204&&(t.handleDeleted(a),r(k("/groups")))})},G=p=>{a&&tn(a,p).then(s=>{s.json().then(S=>g(S))})},fe=p=>{a&&C(p.target.value)},Ce=()=>{a&&(a.internal_notes=_,oe(a).then(p=>{p.status==200&&p.json().then(s=>{b(!0),g(s),C(s.internal_notes)})}))},Y=p=>{if(p.claimed_at){const s=new Date(p.claimed_at);return Math.round(Math.abs((s.getTime()-new Date().getTime())/864e5))}return 0},ye=()=>{j(!0)},ne=()=>{j(!1)},_e=()=>{a&&(a.accommodation=null,oe(a).then(p=>{p.status==200&&g(O({},a))}),ne())},he=()=>{P(!0)},ve=p=>{a&&p&&(a.accommodation=p,oe(a).then(s=>{s.status==200&&g(H(O({},a),{accommodation:p}))})),P(!1)};return i(T,{children:[i(z,{open:t.open,onClose:t.handleClose,scroll:"body",children:[e(F,{children:"Group"}),a?i(T,{children:[e(I,{children:i(D,{children:["Group ID: ",t.groupId]})}),e(I,{children:i(D,{sx:{"& button":{m:1}},children:["Owner:"," ",e(ge,{to:"/attendees/"+a.owner.id,children:a.owner.nickname+(a.owner.fully_paid?" (Paid)":" (Not paid)")}),e(v,{size:"small",variant:"contained",color:"error",onClick:l,children:"Disband Group"})]})}),a.users.filter(p=>p.id!==a.owner.id).map((p,s)=>e(I,{children:i(D,{sx:{"& button":{m:1}},children:[e(ge,{to:"/attendees/"+p.id,children:p.nickname+(p.fully_paid?" (Paid)":" (Not paid)")}),e(v,{size:"small",variant:"contained",color:"error",onClick:()=>o(p.id),children:"Remove from group"}),e(v,{size:"small",variant:"contained",color:"primary",onClick:()=>G(p.id),children:"Make group owner"})]})},s)),e(I,{children:i(R,{children:[e(x,{multiline:!0,rows:4,name:"internal_notes",label:"Internal Notes",value:_||"",onChange:fe,fullWidth:!0,variant:"standard",margin:"dense"}),e(v,{color:f?"success":"primary",onClick:Ce,children:f?"Saved!":"Save internal notes"})]})}),i(I,{children:[a.accommodation?i(D,{sx:{"& button":{m:1}},children:["Accommodation:"," ",e(ge,{to:"/accommodation/"+a.accommodation.id,children:a.accommodation.name}),e(v,{size:"small",variant:"contained",color:"error",onClick:ye,children:"Remove accommodation"}),e("br",{}),"Claimed ",Y(a)," days ago"]}):i(D,{sx:{"& button":{m:1}},children:["No accommodation",e(v,{size:"small",variant:"contained",color:"primary",onClick:he,children:"Add accommodation"})]}),e(ln,{open:E,groupSize:a.users.length,handleClose:ve})]}),e(M,{children:e(v,{onClick:t.handleClose,children:"Close"})})]}):null]}),e(z,{open:w,onClose:ne,children:a?i(T,{children:[e(F,{children:"Remove from group"}),e(I,{children:e(D,{children:"Are you sure?"})}),i(M,{children:[e(v,{onClick:ne,children:"Close"}),e(v,{onClick:_e,children:"Remove from group"})]})]}):null}),e(z,{open:!!n,onClose:d,children:a?i(T,{children:[e(F,{children:"Remove from group"}),e(I,{children:e(D,{children:"Are you sure?"})}),i(M,{children:[e(v,{onClick:d,children:"Close"}),e(v,{onClick:L,children:"Remove from group"})]})]}):null}),e(z,{open:m,onClose:y,children:a?i(T,{children:[e(F,{children:"Disband group"}),e(I,{children:e(D,{children:"Are you sure?"})}),i(M,{children:[e(v,{onClick:y,children:"Close"}),e(v,{onClick:ue,children:"Disband group"})]})]}):null})]})}function je(){const t=K(),{id:r}=ke(),[a,g]=u.exports.useState(""),[n,c]=u.exports.useState([]),[m,h]=u.exports.useState("");u.exports.useEffect(()=>{He().then(o=>{o.status==200?o.json().then(d=>{console.log(d),c(d.results)}):o.status==401?(t(k("/")),t(W()),localStorage.removeItem("TOKEN")):o.json().then(d=>{g("Error while retrieving groups.  Please try again or contact tech."),console.log(d)})})},[]);const _=o=>{t(k("/groups/"+o.id))},C=()=>{t(k("/groups"))},f=o=>{h(o.target.value)},b=o=>o.accommodation&&o.accommodation.name.toLowerCase().includes(m.toLowerCase())||o.owner.nickname.toLowerCase().includes(m.toLowerCase()),E=o=>{for(const d of o.users)if(!d.fully_paid)return!0;return!1},P=o=>{c(n.filter(d=>o.id!==d.id))},w=o=>{if(o.claimed_at){const d=new Date(o.claimed_at);return Math.round(Math.abs((d.getTime()-new Date().getTime())/864e5))}return 0},j=o=>o.accommodation?E(o)?" (Unpaid for "+w(o)+" days)":" (Paid)":"";return i(T,{children:[a?e(de,{severity:"error",children:a}):null,e(x,{fullWidth:!0,id:"outlined-basic",label:"Search",variant:"outlined",onChange:f}),e(Ue,{url:A+"groups.csv",filename:"groups.csv",children:e(se,{"aria-label":"download",sx:{p:{xs:4,md:5}},children:e(We,{})})}),e(pe,{children:n.filter(o=>b(o)).map((o,d)=>e(Z,{children:i(ie,{onClick:()=>_(o),children:[e(le,{children:e(ee,{children:e(Ge,{})})}),e(Q,{primary:o.owner.nickname+"'s group",secondary:o.users.length+" member(s)"+j(o)})]})},d))}),r?e(sn,{open:!0,handleClose:C,groupId:r,handleDeleted:P}):null]})}function cn(){const t=K(),[r,a]=u.exports.useState(""),[g,n]=u.exports.useState([]),[c,m]=u.exports.useState(-1);u.exports.useEffect(()=>{Be().then(f=>{f.status==200?f.json().then(b=>{n(b.results)}):f.status==401?(t(k("/")),t(W()),localStorage.removeItem("TOKEN")):f.json().then(b=>{a("Error while retrieving config.  Please try again or contact tech."),console.log(b)})})},[]);const h=f=>{g[parseInt(f.target.name)].value=f.target.value,n([...g])},_=f=>{nn(g[f]).then(b=>{b.status==200?m(f):b.json().then(E=>{a("Error while retrieving config.  Please try again or contact tech."),console.log(E)})})},C={SIGNUP_MODE:"Current signup page restriction.  Set to 0 for signup closed, 1 for staff-only and 2 for signup open.",RECAPTCHA_MIN_SCORE:"Minimum required ReCAPTCHA assessment score, 0 is fail, 1 is success.  If in doubt, set to 0.3",INTRO_TEXT:"Message displayed on the registration site homepage.",CLAIM_MODE:"Current accommodation claim restriction.  Set to 0 for claim unavailable, 1 for staff-only and 2 for open to all.",SPONSOR_PRICE:"The price to sponsor in pence.",STAFF_DISCOUNT:"The discount staff receive in pence.",LODGE_EXTRA_DAYS:"The price in pence for extra days for lodges as JSON array of 8 prices.  Enter just null for no price.",EXTRA_DAYS:"The price in pence for extra days as JSON array of 8 prices.  Enter just null for no price."};return i(R,{direction:"column",spacing:2,children:[r?e(de,{severity:"error",children:r}):null,g.map((f,b)=>i(R,{direction:"row",alignItems:"center",spacing:2,children:[e(te,{children:f.id}),e(x,{name:""+b,label:"Value",multiline:!0,maxRows:4,value:f.value,onChange:h}),e(te,{width:400,children:C[f.id]}),e(v,{variant:"contained",color:c==b?"success":"primary",onClick:()=>_(b),children:c==b?"Saved!":"Save"})]},b))]})}function dn(t){const r=K(),[a,g]=u.exports.useState(!1),[n,c]=u.exports.useState(),m=Ke.createRef();u.exports.useEffect(()=>{t.isNew?c({id:crypto.randomUUID(),name:"",min_capacity:1,max_capacity:2,availability:0,prices:[null,null,null,null,null,null,null,null],is_lodge:!1,internal_notes:""}):Vt(t.accommodationId).then(o=>{o.status==200?o.json().then(d=>{c(d)}):o.status==401&&(r(k("/")),r(W()),localStorage.removeItem("TOKEN"))})},[]);const h=o=>{n&&c(H(O({},n),{[o.target.name]:o.target.value}))},_=o=>{if(n){const d=[...n.prices];for(let L=0;L<8;L++)(L+1<n.min_capacity||L+1>n.max_capacity)&&(d[L]=null);c(H(O({},n),{prices:d,[o.target.name]:o.target.value}))}},C=o=>{n&&c(H(O({},n),{[o.target.name]:o.target.checked}))},f=o=>{if(n){const d=parseInt(o.target.name.substring(o.target.name.indexOf("_")+1)),L=[...n.prices];L[d-1]=parseInt(o.target.value),c(H(O({},n),{prices:L}))}},b=()=>{g(!0)},E=()=>{g(!1)},P=()=>{n&&Xt(n).then(o=>{o.status==204&&(t.handleDeleted(n),r(k("/accommodation")))})},w=()=>{n&&m.current&&m.current.reportValidity()&&(t.isNew?Yt(n):Zt(n)).then(d=>{(d.status==200||d.status==201)&&(t.handleUpdated(),r(k("/accommodation")))})},j=()=>{n&&n.id&&navigator.clipboard.writeText(n.id)};return i(T,{children:[i(z,{open:t.open,onClose:t.handleClose,scroll:"body",children:[i(R,{direction:"row",alignItems:"center",minWidth:"558px",children:[i(F,{children:[t.isNew?"Create ":null,"Accommodation"]}),n&&!t.isNew?i(D,{children:["ID: ",n.id,e(St,{title:"Copy",children:e(se,{"aria-label":"copy",onClick:j,children:e(xt,{})})})]}):null]}),n?i(T,{children:[e(I,{children:i(R,{component:"form",ref:m,spacing:2,children:[e(x,{name:"name",onChange:h,label:"Accommodation Name",value:n.name,required:!0}),e(ae,{control:e(re,{name:"is_lodge",checked:n.is_lodge,onChange:C}),label:"Is lodge?"}),i(R,{direction:"row",spacing:2,alignItems:"center",justifyContent:"left",children:[e(x,{fullWidth:!0,required:!0,name:"min_capacity",onChange:_,label:"Minimum Occupancy",type:"number",inputProps:{inputMode:"numeric",pattern:"[0-9]*",min:1,max:8},value:n.min_capacity}),e(x,{fullWidth:!0,required:!0,name:"max_capacity",onChange:_,label:"Maximum Occupancy",type:"number",inputProps:{inputMode:"numeric",pattern:"[0-9]*",min:1,max:8},value:n.max_capacity}),e(x,{fullWidth:!0,required:!0,name:"availability",onChange:h,label:"Availability",type:"number",inputProps:{inputMode:"numeric",pattern:"[0-9]*"},value:n.availability})]}),e(R,{direction:"row",children:e(Ee,{container:!0,spacing:2,children:n.prices.map((o,d)=>d+1>=(n.min_capacity||1)&&d+1<=(n.max_capacity||8)&&d+1>=1&&d+1<=8?e(Ee,{item:!0,xs:6,children:e(x,{fullWidth:!0,required:!0,label:"Price for "+(d+1),name:"price_"+(d+1),value:o||"",onChange:f,type:"number",InputProps:{endAdornment:e(Se,{position:"end",children:"p"})}})},d):null)})}),e(x,{fullWidth:!0,name:"internal_notes",onChange:h,label:"Internal Notes",value:n.internal_notes,multiline:!0})]})}),i(M,{children:[t.isNew?e(T,{children:e(v,{onClick:w,children:"Create"})}):i(T,{children:[e(v,{onClick:w,children:"Save"}),e(v,{color:"error",onClick:b,children:"Delete"})]}),e(v,{onClick:t.handleClose,children:"Close"})]})]}):null]}),e(z,{open:a,onClose:E,children:n&&!t.isNew?i(T,{children:[e(F,{children:"Delete Accommodation"}),e(I,{children:e(D,{children:"Are you sure?"})}),i(M,{children:[e(v,{onClick:E,children:"Close"}),e(v,{onClick:P,children:"Delete"})]})]}):null})]})}function Le(){const t=K(),{id:r}=ke(),[a,g]=u.exports.useState(""),[n,c]=u.exports.useState([]),[m,h]=u.exports.useState("");u.exports.useEffect(()=>{_()},[]);const _=()=>{Me().then(o=>{o.status==200?o.json().then(d=>{c(d.results)}):o.status==401?(t(k("/")),t(W()),localStorage.removeItem("TOKEN")):o.json().then(d=>{g("Error while retrieving groups.  Please try again or contact tech."),console.log(d)})})},C=o=>{t(k("/accommodation/"+o.id))},f=()=>{t(k("/accommodation/new"))},b=()=>{t(k("/accommodation"))},E=o=>{h(o.target.value)},P=o=>o.toLowerCase().includes(m.toLowerCase()),w=o=>{c(n.filter(d=>o.id!==d.id))},j=()=>{_()};return i(T,{children:[a?e(de,{severity:"error",children:a}):null,e(x,{fullWidth:!0,id:"outlined-basic",label:"Search",variant:"outlined",onChange:E}),i(pe,{children:[e(Z,{children:i(ie,{onClick:()=>f(),children:[e(le,{children:e(ee,{children:e(Ne,{})})}),e(Q,{primary:"Create New"})]})}),n.filter(o=>P(o.name)).map((o,d)=>e(Z,{children:i(ie,{onClick:()=>C(o),children:[e(le,{children:e(ee,{children:e(be,{})})}),e(Q,{primary:o.name,secondary:i(R,{direction:"row",spacing:4,alignItems:"center",justifyContent:"left",children:[i(R,{direction:"row",spacing:1,alignItems:"center",children:[e(wt,{}),i("span",{children:[o.min_capacity,"-",o.max_capacity]})]}),i(R,{direction:"row",spacing:1,alignItems:"center",children:[e(be,{}),e("span",{children:o.availability+" ("+(o.availability-o.occupied)+" remaining)"})]})]})})]})},d)),e(Z,{children:i(ie,{onClick:()=>f(),children:[e(le,{children:e(ee,{children:e(Ne,{})})}),e(Q,{primary:"Create New"})]})})]}),r?e(dn,{open:!0,handleClose:b,accommodationId:r,handleDeleted:w,handleUpdated:j,isNew:r=="new"}):null]})}kt.render(e(Ke.StrictMode,{children:e(At,{store:Ae,children:e(Dt,{children:e(Tt,{history:Mt,children:i(Ot,{children:[e($,{path:"/",element:e(an,{})}),e($,{path:"/accommodation",element:e(Le,{})}),e($,{path:"/accommodation/:id",element:e(Le,{})}),e($,{path:"/attendees",element:e(Pe,{})}),e($,{path:"/attendees/:id",element:e(Pe,{})}),e($,{path:"/groups",element:e(je,{})}),e($,{path:"/groups/:id",element:e(je,{})}),e($,{path:"/config",element:e(cn,{})})]})})})})}),document.getElementById("root"));Be().then(t=>{t.status==200&&t.json().then(r=>{const a={};r.results.map(g=>{a[g.id]=g.value}),Ae.dispatch(Rt(a))})});

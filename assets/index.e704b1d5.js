var qe=Object.defineProperty,Ue=Object.defineProperties;var Je=Object.getOwnPropertyDescriptors;var Oe=Object.getOwnPropertySymbols;var Ve=Object.prototype.hasOwnProperty,Ye=Object.prototype.propertyIsEnumerable;var Ie=(t,o,a)=>o in t?qe(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,T=(t,o)=>{for(var a in o||(o={}))Ve.call(o,a)&&Ie(t,a,o[a]);if(Oe)for(var a of Oe(o))Ye.call(o,a)&&Ie(t,a,o[a]);return t},B=(t,o)=>Ue(t,Je(o));import{u as Xe,a as Ze,s as ke,M as Qe,c as et,r as u,j as i,T as tt,b as e,C as nt,B as at,d as rt,I as Se,e as ot,f as ne,D as it,g as lt,h as st,i as ct,L as he,k as Q,l as dt,m as ee,n as Ee,o as be,p as ut,q as We,t as ht,v as k,w as Re,x as mt,y as pt,z as gt,F as O,A as ce,P as ft,S as R,E as v,G as F,H as M,J as A,K as $,N as q,O as H,Q as P,R as b,U as Ct,V as yt,W as _t,X as ae,Y as re,Z as Y,_ as xe,$ as ue,a0 as vt,a1 as Te,a2 as Z,a3 as ie,a4 as le,a5 as te,a6 as St,a7 as Ke,a8 as bt,a9 as xt,aa as Ne,ab as De,ac as wt,ad as kt,ae as Tt,af as At,ag as Ot,ah as J}from"./vendor.583484ac.js";const It=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))p(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const h of s.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&p(h)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function p(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}};It();const z=()=>Xe(),X=Ze,se=240,Et=ke("main",{shouldForwardProp:t=>t!=="open"})(({theme:t,open:o})=>T({flexGrow:1,padding:t.spacing(3),transition:t.transitions.create("margin",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),marginLeft:`-${se}px`},o&&{transition:t.transitions.create("margin",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen}),marginLeft:0})),Nt=ke(Qe,{shouldForwardProp:t=>t!=="open"})(({theme:t,open:o})=>T({transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},o&&{width:`calc(100% - ${se}px)`,marginLeft:`${se}px`,transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen})})),Pe=ke("div")(({theme:t})=>B(T({display:"flex",alignItems:"center",padding:t.spacing(0,1)},t.mixins.toolbar),{justifyContent:"flex-end"}));function Dt(t){const o=z(),a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,p=et({palette:{mode:a?"dark":"light"}}),[n,s]=u.exports.useState(!0),h=X(x=>x.user.authed),m=()=>{s(!0)},_=()=>{s(!1)};let C;h?C={"/":{label:"Intro",icon:e(Ee,{})},"/accommodation":{label:"Accommodation",icon:e(be,{})},"/attendees":{label:"Attendees",icon:e(ut,{})},"/groups":{label:"Groups",icon:e(We,{})},"/config":{label:"Config",icon:e(ht,{})}}:C={"/":{label:"Intro",icon:e(Ee,{})}};const f="/"+window.location.pathname.split("/")[1],[S,N]=u.exports.useState(C[f].label),j=x=>{const L=C[x];N(L.label),o(k(x))};return i(tt,{theme:p,children:[e(nt,{}),i(at,{sx:{display:"flex"},children:[e(Nt,{position:"fixed",open:n,children:i(rt,{children:[e(Se,{color:"inherit","aria-label":"open drawer",onClick:m,edge:"start",sx:T({mr:2},n&&{display:"none"}),children:e(ot,{})}),e(ne,{variant:"h6",noWrap:!0,component:"div",children:S})]})}),i(it,{sx:{width:se,flexShrink:0,"& .MuiDrawer-paper":{width:se,boxSizing:"border-box"}},variant:"persistent",anchor:"left",open:n,children:[e(Pe,{children:e(Se,{onClick:_,children:p.direction==="ltr"?e(lt,{}):e(st,{})})}),e(ct,{}),e(he,{children:Object.keys(C).map(x=>i(Q,{button:!0,onClick:()=>j(x),children:[e(dt,{children:C[x].icon}),e(ee,{primary:C[x].label})]},x))})]}),i(Et,{open:n,children:[e(Pe,{}),t.children]})]})]})}const Pt={authed:!!localStorage.getItem("TOKEN")},ze=Re({name:"user",initialState:Pt,reducers:{login(t){t.authed=!0},logout(t){t.authed=!1}}}),{login:jt,logout:K}=ze.actions;var Lt=ze.reducer;const Gt={config:{}},Fe=Re({name:"config",initialState:Gt,reducers:{setConfig(t,o){t.config=o.payload}}}),{setConfig:Wt}=Fe.actions;var Rt=Fe.reducer;const{createReduxHistory:Kt,routerMiddleware:zt,routerReducer:Ft}=mt({history:pt()}),Ae=gt({reducer:{router:Ft,user:Lt,config:Rt},middleware:[zt]}),Mt=Kt(Ae),I=window.location.hostname=="localhost"?"http://localhost:8000/":"https://api.reg.furcation.org.uk/",Ht=window.location.protocol+"//"+window.location.host;function Bt(){return fetch(I+"auth/o/keycloak/?"+new URLSearchParams({redirect_uri:Ht}),{method:"GET",credentials:"include"})}function $t(t,o){return fetch(I+"auth/o/keycloak/",{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({state:t,code:o})})}function qt(){return fetch(I+"auth/users/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Ut(t){return fetch(I+"auth/users/"+t,{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Jt(t){return fetch(I+"auth/users/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function Me(){return fetch(I+"accommodation/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Vt(t){return fetch(I+"accommodation/"+t+"/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Yt(t){return fetch(I+"accommodation/",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function Xt(t){return fetch(I+"accommodation/"+t.id+"/",{method:"DELETE",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Zt(t){return fetch(I+"accommodation/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function He(){return fetch(I+"groups/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function we(t){return fetch(I+"groups/"+t+"/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function Qt(t){return fetch(I+"groups/"+t.id+"/",{method:"DELETE",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function en(t){return fetch(I+"auth/users/"+t.id+"/",{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")}})}function tn(t,o){return fetch(I+"groups/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify({owner:{id:o,nickname:""}})})}function oe(t){return fetch(I+"groups/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify(t)})}function Be(){return fetch(I+"config/",{method:"GET",credentials:"include",headers:{Authorization:"Token "+localStorage.getItem("TOKEN")}})}function nn(t){return fetch(I+"config/"+t.id+"/",{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Token "+localStorage.getItem("TOKEN")},body:JSON.stringify({value:t.value})})}function an(){const t=z(),o=X(h=>h.user.authed),[a,p]=u.exports.useState("");return u.exports.useEffect(()=>{const h=new URLSearchParams(window.location.search),m=h.get("state"),_=h.get("code");!o&&m&&_&&$t(m,_).then(C=>{C.status==201?C.json().then(f=>{localStorage.setItem("TOKEN",f.access),t(jt())}):C.json().then(f=>{p("Login flow expired, please login again."),console.log(f)})})},[]),i(O,{children:[a?e(ce,{severity:"error",children:a}):null,i(ft,{variant:"outlined",sx:{my:{xs:3,md:6},p:{xs:2,md:3}},children:[e(ne,{variant:"h6",color:"inherit",children:"Welcome to Furcation Registation Admin Panel"}),i(ne,{variant:"body1",color:"inherit",paragraph:!0,children:["Welcome to the admin panel here you can view and edit attendees and groups for maintainance or resolving issues. For any issues please contact us:",e("br",{}),e("br",{}),"Registration - reg@furcation.org.uk",e("br",{}),"IT - it@furcation.org.uk"]}),o?e(R,{spacing:2,alignItems:"center",children:e(v,{color:"error",variant:"contained",sx:{minWidth:{sm:400,xs:"100%"}},onClick:()=>{t(K()),localStorage.removeItem("TOKEN")},children:"Logout"})}):e(R,{spacing:2,alignItems:"center",children:e(v,{variant:"contained",sx:{minWidth:{sm:400,xs:"100%"}},onClick:()=>{Bt().then(h=>{h.status==200?h.json().then(m=>{window.location.href=m.authorization_url}):h.json().then(m=>{p("Error while contacting Keycloak, please try again or contact tech."),console.log(m)})})},children:"Login with Keycloak"})})]})]})}function rn(t){const o=z(),[a,p]=u.exports.useState([]),[n,s]=u.exports.useState("");u.exports.useEffect(()=>{He().then(m=>{m.status==200?m.json().then(_=>{p(_.results.filter(C=>C.users.length<8)),s("0")}):m.status==401&&(o(k("/")),o(K()),localStorage.removeItem("TOKEN"))})},[]);const h=m=>{s(m.target.value)};return i(F,{open:t.open,onClose:()=>t.handleClose(null),children:[e(M,{children:"Pick a group"}),a?i(O,{children:[e(A,{children:e($,{value:n,label:"Group",fullWidth:!0,variant:"standard",margin:"dense",onChange:h,children:a.map((m,_)=>i(q,{value:_,children:[m.owner.nickname,"'s Group"]},_))})}),i(H,{children:[e(v,{onClick:()=>t.handleClose(null),children:"Close"}),e(v,{onClick:()=>t.handleClose(a[parseInt(n)]),children:"Confirm"})]})]}):null]})}function on(t){const o=z(),[a,p]=u.exports.useState({}),[n,s]=u.exports.useState(null),[h,m]=u.exports.useState(null),[_,C]=u.exports.useState("1990-01-01"),[f,S]=u.exports.useState(0),[N,j]=u.exports.useState(!1),[x,L]=u.exports.useState(!1),[r,d]=u.exports.useState([]);u.exports.useEffect(()=>{Ut(t.userId).then(c=>{c.status==200?c.json().then(w=>{s(w),C(w.date_of_birth),w.group&&we(w.group).then(D=>{D.status==200&&D.json().then(V=>{m(V)})})}):c.status==401?(o(k("/")),o(K()),localStorage.removeItem("TOKEN")):c.json().then(w=>{p(w)})}),h&&h.accommodation&&h.accommodation.is_lodge?d(y):d(l)},[]);const G=JSON.parse(X(c=>c.config.config.HOODIE_SIZES||"[]")),l=JSON.parse(X(c=>c.config.config.EXTRA_DAYS||"[]")),y=JSON.parse(X(c=>c.config.config.LODGE_EXTRA_DAYS||"[]")),me=JSON.parse(X(c=>c.config.config.SPONSOR_PRICE||"[]")),pe=JSON.parse(X(c=>c.config.config.STAFF_DISCOUNT||"[]")),de=()=>{let c=0;if(n&&h&&h.accommodation){c=h.accommodation.prices[h.users.length-1]||0,n.email.endsWith("@furcation.org.uk")&&(c-=pe);let w=0,D=0;h.users.map(V=>{V.is_early&&(w+=1),V.is_late&&(D+=1)}),n.is_early&&(c+=r[w-1]),n.is_late&&(c+=r[D-1]),n.is_sponsor&&(c+=me),c+=Number(n.adjustments)}return c},W=c=>{n&&(n[c.target.name]=c.target.value,s(T({},n)))},ge=()=>{L(!0)},fe=()=>{n&&en(n).then(c=>{c.status==204&&(t.handleDeleted(n),t.handleClose())})},U=c=>{n&&(n[c.target.name]=c.target.checked,s(T({},n)))},Ce=c=>{n&&(n.hoodie_size=c.target.value,s(T({},n)))},ye=c=>{const w=new Date(c),D=w.getFullYear()+"-"+("0"+(w.getMonth()+1)).slice(-2)+"-"+("0"+w.getDate()).slice(-2);C(D),n&&(n.date_of_birth=D)},_e=()=>{if(n){S(1);const c=T({},n);c.phone_number=g(c.phone_number),c.ice_phone=g(c.ice_phone),delete c.group,Jt(c).then(w=>{console.log(w.status),w.status==200?w.json().then(D=>{S(2),s(D),C(D.date_of_birth),D.group&&we(D.group).then(V=>{V.status==200&&V.json().then($e=>{m($e)})})}):w.status==401?(o(k("/")),o(K()),localStorage.removeItem("TOKEN")):w.status==400&&(S(0),w.json().then(D=>{console.log(D),p(D)}))})}},g=c=>(c=c.replaceAll(" ",""),c.charAt(0)==="0"?"+44"+c.substring(1):c),E=()=>{j(!0)},ve=c=>{n&&c&&(c.users.push({id:n.id,nickname:n.nickname,fully_paid:!1,is_early:!1,is_late:!1}),oe(c).then(w=>{w.status==200&&(s(B(T({},n),{group:c})),m(c))})),j(!1)};return i(O,{children:[i(F,{open:t.open,onClose:t.handleClose,scroll:"body",children:[e(M,{children:"Attendee "}),n?i(O,{children:[i(A,{children:[i(P,{children:["Badge Number:"," ",n.badge_override?n.badge_override+" (Overridden from "+n.id+")":n.id]}),e(b,{required:!0,name:"full_name",label:"Full (Legal) Name",value:n.full_name,onChange:W,autoComplete:"fullname",error:Object.prototype.hasOwnProperty.call(a,"full_name"),helperText:a.full_name,fullWidth:!0,variant:"standard",margin:"dense"}),e(b,{required:!0,name:"nickname",label:"Badge Name (Nickname/Furry Name)",value:n.nickname,onChange:W,autoComplete:"nickname",error:Object.prototype.hasOwnProperty.call(a,"nickname"),helperText:a.nickname,fullWidth:!0,variant:"standard",margin:"dense"}),e(b,{required:!0,name:"email",label:"Email",value:n.email,onChange:W,autoComplete:"email",error:Object.prototype.hasOwnProperty.call(a,"email"),helperText:a.email,fullWidth:!0,variant:"standard",margin:"dense"}),e(Ct,{dateAdapter:yt,children:e(_t,{label:"Date of Birth",value:_,onChange:ye,inputFormat:"yyyy-MM-dd",mask:"____-__-__",renderInput:c=>e(b,B(T({},c),{required:!0,error:Object.prototype.hasOwnProperty.call(a,"date_of_birth"),helperText:a.date_of_birth,fullWidth:!0,variant:"standard",margin:"dense"}))})}),e(b,{required:!0,multiline:!0,rows:4,name:"address",label:"Address",value:n.address,onChange:W,error:Object.prototype.hasOwnProperty.call(a,"address"),helperText:a.address,fullWidth:!0,variant:"standard",margin:"dense"}),e(b,{required:!0,type:"tel",name:"phone_number",label:"Phone Number",autoComplete:"phone",value:n.phone_number,onChange:W,error:Object.prototype.hasOwnProperty.call(a,"phone_number"),helperText:a.phone_number,fullWidth:!0,variant:"standard",margin:"dense"}),e(b,{multiline:!0,rows:4,name:"medical_details",label:"Any medical details we should know? (optional)",value:n.medical_details||"",onChange:W,error:Object.prototype.hasOwnProperty.call(a,"medical_details"),helperText:a.medical_details,fullWidth:!0,variant:"standard",margin:"dense"}),e(b,{required:!0,name:"ice_name",label:"ICE Name",value:n.ice_name,onChange:W,autoComplete:"ice_name",error:Object.prototype.hasOwnProperty.call(a,"ice_name"),helperText:a.ice_name,fullWidth:!0,variant:"standard",margin:"dense"}),e(b,{required:!0,name:"ice_phone",label:"ICE Phone",value:n.ice_phone,onChange:W,autoComplete:"ice_phone",error:Object.prototype.hasOwnProperty.call(a,"ice_phone"),helperText:a.ice_phone,fullWidth:!0,variant:"standard",margin:"dense"}),e(ae,{control:e(re,{name:"is_fursuiter",checked:n.is_fursuiter,onChange:U}),label:"Fursuiter"}),e(ae,{control:e(re,{name:"is_early",checked:n.is_early,onChange:U}),label:"Early"}),e(ae,{control:e(re,{name:"is_late",checked:n.is_late,onChange:U}),label:"Late"}),e(ae,{control:e(re,{name:"is_sponsor",checked:n.is_sponsor,onChange:U}),label:"Sponsor"}),e(Y,{shrink:!0,children:"Hoodie Size"}),e($,{value:n.hoodie_size,fullWidth:!0,variant:"standard",margin:"dense",label:"Hoodie Size",onChange:Ce,children:G.map(c=>e(q,{value:c,children:e(ne,{color:"text.primary",children:c})},c))}),e(b,{name:"badge_override",label:"Badge Number Override",value:n.badge_override,onChange:W,autoComplete:"badge_override",error:Object.prototype.hasOwnProperty.call(a,"badge_override"),helperText:a.badge_override,fullWidth:!0,variant:"standard",margin:"dense"}),e(b,{name:"paid",label:"Amount paid",value:n.paid,onChange:W,autoComplete:"paid",type:"number",error:Object.prototype.hasOwnProperty.call(a,"paid"),InputProps:{endAdornment:e(xe,{position:"end",children:"p"})},helperText:a.paid,fullWidth:!0,variant:"standard",margin:"dense"}),e(b,{name:"adjustments",label:"Bill adjustments",value:n.adjustments,onChange:W,autoComplete:"adjustments",type:"number",error:Object.prototype.hasOwnProperty.call(a,"adjustments"),InputProps:{endAdornment:e(xe,{position:"end",children:"p"})},helperText:a.adjustments,fullWidth:!0,variant:"standard",margin:"dense"})]}),e(A,{children:i(P,{children:["Total Bill: \xA3",(de()/100).toFixed(2)]})}),e(A,{children:i(P,{children:["Left to pay: \xA3",((de()-n.paid)/100).toFixed(2)]})}),e(A,{children:e(b,{multiline:!0,rows:4,name:"internal_notes",label:"Internal Notes",value:n.internal_notes||"",onChange:W,error:Object.prototype.hasOwnProperty.call(a,"internal_notes"),helperText:a.internal_notes,fullWidth:!0,variant:"standard",margin:"dense"})}),e(A,{children:h?i(P,{children:["Group:"," ",i(ue,{to:"/groups/"+h.id,children:[h.owner.nickname,"'s Group"]})]}):i(P,{sx:{"& button":{m:1}},children:["No group",e(v,{size:"small",variant:"contained",color:"primary",onClick:E,children:"Add to a group"})]})}),i(H,{children:[e(v,{onClick:t.handleClose,children:"Close"}),e(v,{color:"error",onClick:ge,children:"Delete"}),e(vt,{loading:f==1,color:f==2?"success":"primary",onClick:_e,children:f==2?"Saved!":"Save Changes"})]})]}):null]}),N?e(rn,{open:!0,handleClose:ve}):null,i(F,{open:x,onClose:t.handleClose,children:[e(M,{children:"Delete Attendee"}),e(A,{children:e(P,{children:"Are you sure you want to delete this attendee?"})}),i(H,{children:[e(v,{onClick:t.handleClose,children:"Cancel"}),e(v,{onClick:fe,color:"error",variant:"contained",children:"Delete"})]})]})]})}function je(){const t=z(),o=["Not Filtered","Yes","No"],{id:a}=Te(),[p,n]=u.exports.useState(""),[s,h]=u.exports.useState({is_early:"Not Filtered",is_late:"Not Filtered",is_sponsor:"Not Filtered",is_active:"Yes",is_staff:"Not Filtered",is_admin:"No"}),[m,_]=u.exports.useState([]),[C,f]=u.exports.useState("");u.exports.useEffect(()=>{S()},[]);const S=()=>{qt().then(l=>{l.status==200?l.json().then(y=>{_(y.results)}):l.status==401?(t(k("/")),t(K()),localStorage.removeItem("TOKEN")):l.json().then(()=>{n("Error while retrieving attendees.  Please try again or contact tech.")})})},N=l=>{_(m.filter(()=>l.id!==l.id))},j=l=>{t(k("/attendees/"+l.id))},x=()=>{t(k("/attendees")),S()},L=l=>{f(l.target.value)},r=l=>{console.log(l.target.name+": "+l.target.value),s[l.target.name]=l.target.value,h(T({},s))},d=l=>l.toLowerCase().includes(C.toLowerCase()),G=l=>{let y=!0;return y=s.is_early==o[0]?y:s.is_early==o[1]?y&&l.is_early:y&&!l.is_early,y=s.is_late==o[0]?y:s.is_late==o[1]?y&&l.is_late:y&&!l.is_late,y=s.is_sponsor==o[0]?y:s.is_sponsor==o[1]?y&&l.is_sponsor:y&&!l.is_sponsor,y=s.is_staff==o[0]?y:s.is_staff==o[1]?y&&l.email.endsWith("@furcation.org.uk"):y&&!l.email.endsWith("@furcation.org.uk"),y=s.is_active==o[0]?y:s.is_active==o[1]?y&&l.status=="active":y&&l.status!="active",y=s.is_admin==o[0]?y:s.is_admin==o[1]?y&&l.is_staff:y&&!l.is_staff,y};return i(O,{children:[p?e(ce,{severity:"error",children:p}):null,e(b,{fullWidth:!0,id:"outlined-basic",label:"Search",variant:"outlined",onChange:L}),i(Z,{sx:{minWidth:{xs:"16%"},p:{xs:2,md:3}},children:[e(Y,{sx:{p:{xs:3,md:4}},children:"Early"}),e($,{value:s.is_early,label:"Early",name:"is_early",onChange:r,children:o.map(l=>e(q,{value:l,children:l},l))})]}),i(Z,{sx:{minWidth:{xs:"16%"},p:{xs:2,md:3}},children:[e(Y,{sx:{p:{xs:3,md:4}},children:"Late"}),e($,{value:s.is_late,label:"Late",name:"is_late",onChange:r,children:o.map(l=>e(q,{value:l,children:l},l))})]}),i(Z,{sx:{minWidth:{xs:"16%"},p:{xs:2,md:3}},children:[e(Y,{sx:{p:{xs:3,md:4}},children:"Sponsor"}),e($,{value:s.is_sponsor,label:"Sponsor",name:"is_sponsor",onChange:r,children:o.map(l=>e(q,{value:l,children:l},l))})]}),i(Z,{sx:{minWidth:{xs:"16%"},p:{xs:2,md:3}},children:[e(Y,{sx:{p:{xs:3,md:4}},children:"Active"}),e($,{value:s.is_active,label:"Active",name:"is_active",onChange:r,children:o.map(l=>e(q,{value:l,children:l},l))})]}),i(Z,{sx:{minWidth:{xs:"16%"},p:{xs:2,md:3}},children:[e(Y,{sx:{p:{xs:3,md:4}},children:"Staff"}),e($,{value:s.is_staff,label:"Staff",name:"is_staff",onChange:r,children:o.map(l=>e(q,{value:l,children:l},l))})]}),i(Z,{sx:{minWidth:{xs:"16%"},p:{xs:2,md:3}},children:[e(Y,{sx:{p:{xs:3,md:4}},children:"Admin"}),e($,{value:s.is_admin,label:"Admin",name:"is_admin",onChange:r,children:o.map(l=>e(q,{value:l,children:l},l))})]}),e(he,{children:m.filter(l=>(d(l.full_name)||d(l.nickname)||d(l.email)||d(l.id+"")||d(l.badge_override))&&G(l)).map((l,y)=>e(Q,{children:i(ie,{onClick:()=>j(l),children:[e(le,{children:l.badge_image?e(te,{src:"https://storage.googleapis.com/reggie-badges/"+l.badge_image}):e(te,{children:e(St,{})})}),e(ee,{primary:l.nickname,secondary:l.full_name+" - "+l.email+" - #"+(l.badge_override?l.badge_override+" (Overridden from "+l.id+")":l.id)})]})},y))}),a?e(on,{open:!0,handleClose:x,userId:a,handleDeleted:N}):null]})}function ln(t){const o=z(),[a,p]=u.exports.useState([]),[n,s]=u.exports.useState("");u.exports.useEffect(()=>{Me().then(m=>{m.status==200?m.json().then(_=>{p(_.results.filter(C=>C.min_capacity<=t.groupSize&&C.max_capacity>=t.groupSize)),s("0")}):m.status==401&&(o(k("/")),o(K()),localStorage.removeItem("TOKEN"))})},[]);const h=m=>{s(m.target.value)};return i(F,{open:t.open,onClose:()=>t.handleClose(null),children:[e(M,{children:"Pick accommodation"}),a?i(O,{children:[e(A,{children:e($,{value:n,label:"Accommodation",fullWidth:!0,variant:"standard",margin:"dense",onChange:h,children:a.map((m,_)=>e(q,{value:_,children:m.name},_))})}),i(H,{children:[e(v,{onClick:()=>t.handleClose(null),children:"Close"}),e(v,{onClick:()=>t.handleClose(a[parseInt(n)]),children:"Confirm"})]})]}):null]})}function sn(t){const o=z(),[a,p]=u.exports.useState(null),[n,s]=u.exports.useState(0),[h,m]=u.exports.useState(!1),[_,C]=u.exports.useState(""),[f,S]=u.exports.useState(!1),[N,j]=u.exports.useState(!1),[x,L]=u.exports.useState(!1);u.exports.useEffect(()=>{we(t.groupId).then(g=>{g.status==200?g.json().then(E=>{p(E),C(E.internal_notes)}):g.status==401&&(o(k("/")),o(K()),localStorage.removeItem("TOKEN"))})},[]);const r=g=>{s(g)},d=()=>{s(0)},G=()=>{a&&(a.users=a.users.filter(g=>g.id!==n),oe(a).then(g=>{g.status==200&&g.json().then(E=>{p(E),s(0)})}))},l=()=>{m(!0)},y=()=>{m(!1)},me=()=>{a&&Qt(a).then(g=>{g.status==204&&(t.handleDeleted(a),o(k("/groups")))})},pe=g=>{a&&tn(a,g).then(E=>{E.json().then(ve=>p(ve))})},de=g=>{a&&C(g.target.value)},W=()=>{a&&(a.internal_notes=_,oe(a).then(g=>{g.status==200&&g.json().then(E=>{S(!0),p(E),C(E.internal_notes)})}))},ge=g=>{if(g.claimed_at){const E=new Date(g.claimed_at);return Math.round(Math.abs((E.getTime()-new Date().getTime())/864e5))}return 0},fe=()=>{L(!0)},U=()=>{L(!1)},Ce=()=>{a&&(a.accommodation=null,oe(a).then(g=>{g.status==200&&p(T({},a))}),U())},ye=()=>{j(!0)},_e=g=>{a&&g&&(a.accommodation=g,oe(a).then(E=>{E.status==200&&p(B(T({},a),{accommodation:g}))})),j(!1)};return i(O,{children:[i(F,{open:t.open,onClose:t.handleClose,scroll:"body",children:[e(M,{children:"Group"}),a?i(O,{children:[e(A,{children:i(P,{children:["Group ID: ",t.groupId]})}),e(A,{children:i(P,{sx:{"& button":{m:1}},children:["Owner:"," ",e(ue,{to:"/attendees/"+a.owner.id,children:a.owner.nickname+(a.owner.fully_paid?" (Paid)":" (Not paid)")}),e(v,{size:"small",variant:"contained",color:"error",onClick:l,children:"Disband Group"})]})}),a.users.filter(g=>g.id!==a.owner.id).map((g,E)=>e(A,{children:i(P,{sx:{"& button":{m:1}},children:[e(ue,{to:"/attendees/"+g.id,children:g.nickname+(g.fully_paid?" (Paid)":" (Not paid)")}),e(v,{size:"small",variant:"contained",color:"error",onClick:()=>r(g.id),children:"Remove from group"}),e(v,{size:"small",variant:"contained",color:"primary",onClick:()=>pe(g.id),children:"Make group owner"})]})},E)),e(A,{children:i(R,{children:[e(b,{multiline:!0,rows:4,name:"internal_notes",label:"Internal Notes",value:_||"",onChange:de,fullWidth:!0,variant:"standard",margin:"dense"}),e(v,{color:f?"success":"primary",onClick:W,children:f?"Saved!":"Save internal notes"})]})}),i(A,{children:[a.accommodation?i(P,{sx:{"& button":{m:1}},children:["Accommodation:"," ",e(ue,{to:"/accommodation/"+a.accommodation.id,children:a.accommodation.name}),e(v,{size:"small",variant:"contained",color:"error",onClick:fe,children:"Remove accommodation"}),e("br",{}),"Claimed ",ge(a)," days ago"]}):i(P,{sx:{"& button":{m:1}},children:["No accommodation",e(v,{size:"small",variant:"contained",color:"primary",onClick:ye,children:"Add accommodation"})]}),e(ln,{open:N,groupSize:a.users.length,handleClose:_e})]}),e(H,{children:e(v,{onClick:t.handleClose,children:"Close"})})]}):null]}),e(F,{open:x,onClose:U,children:a?i(O,{children:[e(M,{children:"Remove from group"}),e(A,{children:e(P,{children:"Are you sure?"})}),i(H,{children:[e(v,{onClick:U,children:"Close"}),e(v,{onClick:Ce,children:"Remove from group"})]})]}):null}),e(F,{open:!!n,onClose:d,children:a?i(O,{children:[e(M,{children:"Remove from group"}),e(A,{children:e(P,{children:"Are you sure?"})}),i(H,{children:[e(v,{onClick:d,children:"Close"}),e(v,{onClick:G,children:"Remove from group"})]})]}):null}),e(F,{open:h,onClose:y,children:a?i(O,{children:[e(M,{children:"Disband group"}),e(A,{children:e(P,{children:"Are you sure?"})}),i(H,{children:[e(v,{onClick:y,children:"Close"}),e(v,{onClick:me,children:"Disband group"})]})]}):null})]})}function Le(){const t=z(),{id:o}=Te(),[a,p]=u.exports.useState(""),[n,s]=u.exports.useState([]),[h,m]=u.exports.useState("");u.exports.useEffect(()=>{He().then(r=>{r.status==200?r.json().then(d=>{console.log(d),s(d.results)}):r.status==401?(t(k("/")),t(K()),localStorage.removeItem("TOKEN")):r.json().then(d=>{p("Error while retrieving groups.  Please try again or contact tech."),console.log(d)})})},[]);const _=r=>{t(k("/groups/"+r.id))},C=()=>{t(k("/groups"))},f=r=>{m(r.target.value)},S=r=>r.accommodation&&r.accommodation.name.toLowerCase().includes(h.toLowerCase())||r.owner.nickname.toLowerCase().includes(h.toLowerCase()),N=r=>{for(const d of r.users)if(!d.fully_paid)return!0;return!1},j=r=>{s(n.filter(d=>r.id!==d.id))},x=r=>{if(r.claimed_at){const d=new Date(r.claimed_at);return Math.round(Math.abs((d.getTime()-new Date().getTime())/864e5))}return 0},L=r=>r.accommodation?N(r)?" (Unpaid for "+x(r)+" days)":" (Paid)":"";return i(O,{children:[a?e(ce,{severity:"error",children:a}):null,e(b,{fullWidth:!0,id:"outlined-basic",label:"Search",variant:"outlined",onChange:f}),e(he,{children:n.filter(r=>S(r)).map((r,d)=>e(Q,{children:i(ie,{onClick:()=>_(r),children:[e(le,{children:e(te,{children:e(We,{})})}),e(ee,{primary:r.owner.nickname+"'s group",secondary:r.users.length+" member(s)"+L(r)})]})},d))}),o?e(sn,{open:!0,handleClose:C,groupId:o,handleDeleted:j}):null]})}function cn(){const t=z(),[o,a]=u.exports.useState(""),[p,n]=u.exports.useState([]),[s,h]=u.exports.useState(-1);u.exports.useEffect(()=>{Be().then(f=>{f.status==200?f.json().then(S=>{n(S.results)}):f.status==401?(t(k("/")),t(K()),localStorage.removeItem("TOKEN")):f.json().then(S=>{a("Error while retrieving config.  Please try again or contact tech."),console.log(S)})})},[]);const m=f=>{p[parseInt(f.target.name)].value=f.target.value,n([...p])},_=f=>{nn(p[f]).then(S=>{S.status==200?h(f):S.json().then(N=>{a("Error while retrieving config.  Please try again or contact tech."),console.log(N)})})},C={SIGNUP_MODE:"Current signup page restriction.  Set to 0 for signup closed, 1 for staff-only and 2 for signup open.",RECAPTCHA_MIN_SCORE:"Minimum required ReCAPTCHA assessment score, 0 is fail, 1 is success.  If in doubt, set to 0.3",INTRO_TEXT:"Message displayed on the registration site homepage.",CLAIM_MODE:"Current accommodation claim restriction.  Set to 0 for claim unavailable, 1 for staff-only and 2 for open to all.",SPONSOR_PRICE:"The price to sponsor in pence.",STAFF_DISCOUNT:"The discount staff receive in pence.",LODGE_EXTRA_DAYS:"The price in pence for extra days for lodges as JSON array of 8 prices.  Enter just null for no price.",EXTRA_DAYS:"The price in pence for extra days as JSON array of 8 prices.  Enter just null for no price."};return i(R,{direction:"column",spacing:2,children:[o?e(ce,{severity:"error",children:o}):null,p.map((f,S)=>i(R,{direction:"row",alignItems:"center",spacing:2,children:[e(ne,{children:f.id}),e(b,{name:""+S,label:"Value",multiline:!0,maxRows:4,value:f.value,onChange:m}),e(ne,{width:400,children:C[f.id]}),e(v,{variant:"contained",color:s==S?"success":"primary",onClick:()=>_(S),children:s==S?"Saved!":"Save"})]},S))]})}function dn(t){const o=z(),[a,p]=u.exports.useState(!1),[n,s]=u.exports.useState(),h=Ke.createRef();u.exports.useEffect(()=>{t.isNew?s({id:crypto.randomUUID(),name:"",min_capacity:1,max_capacity:2,availability:0,prices:[null,null,null,null,null,null,null,null],is_lodge:!1,internal_notes:""}):Vt(t.accommodationId).then(r=>{r.status==200?r.json().then(d=>{s(d)}):r.status==401&&(o(k("/")),o(K()),localStorage.removeItem("TOKEN"))})},[]);const m=r=>{n&&s(B(T({},n),{[r.target.name]:r.target.value}))},_=r=>{if(n){const d=[...n.prices];for(let G=0;G<8;G++)(G+1<n.min_capacity||G+1>n.max_capacity)&&(d[G]=null);s(B(T({},n),{prices:d,[r.target.name]:r.target.value}))}},C=r=>{n&&s(B(T({},n),{[r.target.name]:r.target.checked}))},f=r=>{if(n){const d=parseInt(r.target.name.substring(r.target.name.indexOf("_")+1)),G=[...n.prices];G[d-1]=parseInt(r.target.value),s(B(T({},n),{prices:G}))}},S=()=>{p(!0)},N=()=>{p(!1)},j=()=>{n&&Xt(n).then(r=>{r.status==204&&(t.handleDeleted(n),o(k("/accommodation")))})},x=()=>{n&&h.current&&h.current.reportValidity()&&(t.isNew?Yt(n):Zt(n)).then(d=>{(d.status==200||d.status==201)&&(t.handleUpdated(),o(k("/accommodation")))})},L=()=>{n&&n.id&&navigator.clipboard.writeText(n.id)};return i(O,{children:[i(F,{open:t.open,onClose:t.handleClose,scroll:"body",children:[i(R,{direction:"row",alignItems:"center",minWidth:"558px",children:[i(M,{children:[t.isNew?"Create ":null,"Accommodation"]}),n&&!t.isNew?i(P,{children:["ID: ",n.id,e(bt,{title:"Copy",children:e(Se,{"aria-label":"copy",onClick:L,children:e(xt,{})})})]}):null]}),n?i(O,{children:[e(A,{children:i(R,{component:"form",ref:h,spacing:2,children:[e(b,{name:"name",onChange:m,label:"Accommodation Name",value:n.name,required:!0}),e(ae,{control:e(re,{name:"is_lodge",checked:n.is_lodge,onChange:C}),label:"Is lodge?"}),i(R,{direction:"row",spacing:2,alignItems:"center",justifyContent:"left",children:[e(b,{fullWidth:!0,required:!0,name:"min_capacity",onChange:_,label:"Minimum Occupancy",type:"number",inputProps:{inputMode:"numeric",pattern:"[0-9]*",min:1,max:8},value:n.min_capacity}),e(b,{fullWidth:!0,required:!0,name:"max_capacity",onChange:_,label:"Maximum Occupancy",type:"number",inputProps:{inputMode:"numeric",pattern:"[0-9]*",min:1,max:8},value:n.max_capacity}),e(b,{fullWidth:!0,required:!0,name:"availability",onChange:m,label:"Availability",type:"number",inputProps:{inputMode:"numeric",pattern:"[0-9]*"},value:n.availability})]}),e(R,{direction:"row",children:e(Ne,{container:!0,spacing:2,children:n.prices.map((r,d)=>d+1>=(n.min_capacity||1)&&d+1<=(n.max_capacity||8)&&d+1>=1&&d+1<=8?e(Ne,{item:!0,xs:6,children:e(b,{fullWidth:!0,required:!0,label:"Price for "+(d+1),name:"price_"+(d+1),value:r||"",onChange:f,type:"number",InputProps:{endAdornment:e(xe,{position:"end",children:"p"})}})},d):null)})}),e(b,{fullWidth:!0,name:"internal_notes",onChange:m,label:"Internal Notes",value:n.internal_notes,multiline:!0})]})}),i(H,{children:[t.isNew?e(O,{children:e(v,{onClick:x,children:"Create"})}):i(O,{children:[e(v,{onClick:x,children:"Save"}),e(v,{color:"error",onClick:S,children:"Delete"})]}),e(v,{onClick:t.handleClose,children:"Close"})]})]}):null]}),e(F,{open:a,onClose:N,children:n&&!t.isNew?i(O,{children:[e(M,{children:"Delete Accommodation"}),e(A,{children:e(P,{children:"Are you sure?"})}),i(H,{children:[e(v,{onClick:N,children:"Close"}),e(v,{onClick:j,children:"Delete"})]})]}):null})]})}function Ge(){const t=z(),{id:o}=Te(),[a,p]=u.exports.useState(""),[n,s]=u.exports.useState([]),[h,m]=u.exports.useState("");u.exports.useEffect(()=>{_()},[]);const _=()=>{Me().then(r=>{r.status==200?r.json().then(d=>{s(d.results)}):r.status==401?(t(k("/")),t(K()),localStorage.removeItem("TOKEN")):r.json().then(d=>{p("Error while retrieving groups.  Please try again or contact tech."),console.log(d)})})},C=r=>{t(k("/accommodation/"+r.id))},f=()=>{t(k("/accommodation/new"))},S=()=>{t(k("/accommodation"))},N=r=>{m(r.target.value)},j=r=>r.toLowerCase().includes(h.toLowerCase()),x=r=>{s(n.filter(d=>r.id!==d.id))},L=()=>{_()};return i(O,{children:[a?e(ce,{severity:"error",children:a}):null,e(b,{fullWidth:!0,id:"outlined-basic",label:"Search",variant:"outlined",onChange:N}),i(he,{children:[e(Q,{children:i(ie,{onClick:()=>f(),children:[e(le,{children:e(te,{children:e(De,{})})}),e(ee,{primary:"Create New"})]})}),n.filter(r=>j(r.name)).map((r,d)=>e(Q,{children:i(ie,{onClick:()=>C(r),children:[e(le,{children:e(te,{children:e(be,{})})}),e(ee,{primary:r.name,secondary:i(R,{direction:"row",spacing:4,alignItems:"center",justifyContent:"left",children:[i(R,{direction:"row",spacing:1,alignItems:"center",children:[e(wt,{}),i("span",{children:[r.min_capacity,"-",r.max_capacity]})]}),i(R,{direction:"row",spacing:1,alignItems:"center",children:[e(be,{}),e("span",{children:r.availability+" ("+(r.availability-r.occupied)+" remaining)"})]})]})})]})},d)),e(Q,{children:i(ie,{onClick:()=>f(),children:[e(le,{children:e(te,{children:e(De,{})})}),e(ee,{primary:"Create New"})]})})]}),o?e(dn,{open:!0,handleClose:S,accommodationId:o,handleDeleted:x,handleUpdated:L,isNew:o=="new"}):null]})}kt.render(e(Ke.StrictMode,{children:e(Tt,{store:Ae,children:e(Dt,{children:e(At,{history:Mt,children:i(Ot,{children:[e(J,{path:"/",element:e(an,{})}),e(J,{path:"/accommodation",element:e(Ge,{})}),e(J,{path:"/accommodation/:id",element:e(Ge,{})}),e(J,{path:"/attendees",element:e(je,{})}),e(J,{path:"/attendees/:id",element:e(je,{})}),e(J,{path:"/groups",element:e(Le,{})}),e(J,{path:"/groups/:id",element:e(Le,{})}),e(J,{path:"/config",element:e(cn,{})})]})})})})}),document.getElementById("root"));Be().then(t=>{t.status==200&&t.json().then(o=>{const a={};o.results.map(p=>{a[p.id]=p.value}),Ae.dispatch(Wt(a))})});
